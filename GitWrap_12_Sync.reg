Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\SOFTWARE\Classes\Directory\ContextMenus\GitWrap\shell\11_Sync\command]
; $cmd = @'
; # -----------
; # Sync Remote
; # -----------

; Add-Type -AssemblyName PresentationFramework

; $ProgressBlock = {
; [console]::WindowHeight = 2
; #[console]::BufferHeight = 2

; [console]::WindowWidth = 40
; [console]::BufferWidth = 40

; while ($true) {
;     1..100 | foreach {
;         Write-Progress -Activity "Processing" -Status "`0" -PercentComplete $_
;         Start-Sleep -Milliseconds 50
;     }
; }
; }

; $ThisBranch = ((git branch -l) | where {$_ -like '`**'}).Substring(2)
; try {
;     $RemoteBranches = (git branch -r).replace('origin/','').substring(2)

;     if (!($Thisbranch -in $RemoteBranches)) {# the local branch hasn't been pushed
;         $Progress = Start-Process PWSH "-noexit -command $ProgressBlock" -PassThru
;         git push --set-upstream origin $ThisBranch
;         $Progress.Kill()
;     }
    
; } catch {# repo has no remotes at all
;     $Progress.Kill()
; }


; try {
;     $Progress = Start-Process PWSH "-noexit -command $ProgressBlock" -PassThru

;     [string[]]$Result = git pull 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}

;     [string[]]$Result = git push 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}

;     $Progress.Kill()

; } catch {
;     $Progress.Kill()
;     [System.Windows.MessageBox]::Show(
;         $Result[0],'Git for Windows',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; # Update File Explorer
; $ThisGitStatus = Write-VcsStatus
; $ThisGitStatus = $ThisGitStatus | ForEach-Object { $_ -replace '\x1b\[[0-9;]*m','' }
; $ThisGitStatus = (Get-GitStatus).RepoName + ' ' + $ThisGitStatus

; Add-Type -Namespace Util -Name WinApi  -MemberDefinition @"
;   [DllImport("user32.dll")]
;   public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
; "@

; $hwndTopMostFileExplorer = [Util.WinApi]::FindWindow(
;   "CabinetWClass",     # the window class of interest
;   [NullString]::Value  # no window title to search for
; )

; Add-Type -TypeDefinition @"
; using System;
; using System.Runtime.InteropServices;

; public static class Win32 {
;   [DllImport("User32.dll", EntryPoint="SetWindowText")]
;   public static extern int SetWindowText(IntPtr hWnd, string strTitle);
; }
; "@

; [Win32]::SetWindowText($hwndTopMostFileExplorer, $ThisGitStatus)

; [System.Windows.MessageBox]::Show(
;     $Result[0],'Git for Windows',0,'Info',0,'DefaultDesktopOnly'
; )
; '@
; [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($cmd))

@="pwsh.exe -WindowStyle hidden -EncodedCommand IwAgAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAKACMAIABTAHkAbgBjACAAUgBlAG0AbwB0AGUACgAjACAALQAtAC0ALQAtAC0ALQAtAC0ALQAtAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAEEAcwBzAGUAbQBiAGwAeQBOAGEAbQBlACAAUAByAGUAcwBlAG4AdABhAHQAaQBvAG4ARgByAGEAbQBlAHcAbwByAGsACgAKACQAUAByAG8AZwByAGUAcwBzAEIAbABvAGMAawAgAD0AIAB7AAoAWwBjAG8AbgBzAG8AbABlAF0AOgA6AFcAaQBuAGQAbwB3AEgAZQBpAGcAaAB0ACAAPQAgADIACgAjAFsAYwBvAG4AcwBvAGwAZQBdADoAOgBCAHUAZgBmAGUAcgBIAGUAaQBnAGgAdAAgAD0AIAAyAAoACgBbAGMAbwBuAHMAbwBsAGUAXQA6ADoAVwBpAG4AZABvAHcAVwBpAGQAdABoACAAPQAgADQAMAAKAFsAYwBvAG4AcwBvAGwAZQBdADoAOgBCAHUAZgBmAGUAcgBXAGkAZAB0AGgAIAA9ACAANAAwAAoACgB3AGgAaQBsAGUAIAAoACQAdAByAHUAZQApACAAewAKACAAIAAgACAAMQAuAC4AMQAwADAAIAB8ACAAZgBvAHIAZQBhAGMAaAAgAHsACgAgACAAIAAgACAAIAAgACAAVwByAGkAdABlAC0AUAByAG8AZwByAGUAcwBzACAALQBBAGMAdABpAHYAaQB0AHkAIAAiAFAAcgBvAGMAZQBzAHMAaQBuAGcAIgAgAC0AUwB0AGEAdAB1AHMAIAAiAGAAMAAiACAALQBQAGUAcgBjAGUAbgB0AEMAbwBtAHAAbABlAHQAZQAgACQAXwAKACAAIAAgACAAIAAgACAAIABTAHQAYQByAHQALQBTAGwAZQBlAHAAIAAtAE0AaQBsAGwAaQBzAGUAYwBvAG4AZABzACAANQAwAAoAIAAgACAAIAB9AAoAfQAKAH0ACgAKACQAVABoAGkAcwBCAHIAYQBuAGMAaAAgAD0AIAAoACgAZwBpAHQAIABiAHIAYQBuAGMAaAAgAC0AbAApACAAfAAgAHcAaABlAHIAZQAgAHsAJABfACAALQBsAGkAawBlACAAJwBgACoAKgAnAH0AKQAuAFMAdQBiAHMAdAByAGkAbgBnACgAMgApAAoAdAByAHkAIAB7AAoAIAAgACAAIAAkAFIAZQBtAG8AdABlAEIAcgBhAG4AYwBoAGUAcwAgAD0AIAAoAGcAaQB0ACAAYgByAGEAbgBjAGgAIAAtAHIAKQAuAHIAZQBwAGwAYQBjAGUAKAAnAG8AcgBpAGcAaQBuAC8AJwAsACcAJwApAC4AcwB1AGIAcwB0AHIAaQBuAGcAKAAyACkACgAKACAAIAAgACAAaQBmACAAKAAhACgAJABUAGgAaQBzAGIAcgBhAG4AYwBoACAALQBpAG4AIAAkAFIAZQBtAG8AdABlAEIAcgBhAG4AYwBoAGUAcwApACkAIAB7ACMAIAB0AGgAZQAgAGwAbwBjAGEAbAAgAGIAcgBhAG4AYwBoACAAaABhAHMAbgAnAHQAIABiAGUAZQBuACAAcAB1AHMAaABlAGQACgAgACAAIAAgACAAIAAgACAAJABQAHIAbwBnAHIAZQBzAHMAIAA9ACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgAFAAVwBTAEgAIAAiAC0AbgBvAGUAeABpAHQAIAAtAGMAbwBtAG0AYQBuAGQAIAAkAFAAcgBvAGcAcgBlAHMAcwBCAGwAbwBjAGsAIgAgAC0AUABhAHMAcwBUAGgAcgB1AAoAIAAgACAAIAAgACAAIAAgAGcAaQB0ACAAcAB1AHMAaAAgAC0ALQBzAGUAdAAtAHUAcABzAHQAcgBlAGEAbQAgAG8AcgBpAGcAaQBuACAAJABUAGgAaQBzAEIAcgBhAG4AYwBoAAoAIAAgACAAIAAgACAAIAAgACQAUAByAG8AZwByAGUAcwBzAC4ASwBpAGwAbAAoACkACgAgACAAIAAgAH0ACgAgACAAIAAgAAoAfQAgAGMAYQB0AGMAaAAgAHsAIwAgAHIAZQBwAG8AIABoAGEAcwAgAG4AbwAgAHIAZQBtAG8AdABlAHMAIABhAHQAIABhAGwAbAAKACAAIAAgACAAJABQAHIAbwBnAHIAZQBzAHMALgBLAGkAbABsACgAKQAKAH0ACgAKAAoAdAByAHkAIAB7AAoAIAAgACAAIAAkAFAAcgBvAGcAcgBlAHMAcwAgAD0AIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAAUABXAFMASAAgACIALQBuAG8AZQB4AGkAdAAgAC0AYwBvAG0AbQBhAG4AZAAgACQAUAByAG8AZwByAGUAcwBzAEIAbABvAGMAawAiACAALQBQAGEAcwBzAFQAaAByAHUACgAKACAAIAAgACAAWwBzAHQAcgBpAG4AZwBbAF0AXQAkAFIAZQBzAHUAbAB0ACAAPQAgAGcAaQB0ACAAcAB1AGwAbAAgADIAPgAmADEACgAgACAAIAAgAGkAZgAgACgAJABSAGUAcwB1AGwAdAAuAEUAeABjAGUAcAB0AGkAbwBuACkAIAB7AHQAaAByAG8AdwAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwB0AG8AcAB9AAoACgAgACAAIAAgAFsAcwB0AHIAaQBuAGcAWwBdAF0AJABSAGUAcwB1AGwAdAAgAD0AIABnAGkAdAAgAHAAdQBzAGgAIAAyAD4AJgAxAAoAIAAgACAAIABpAGYAIAAoACQAUgBlAHMAdQBsAHQALgBFAHgAYwBlAHAAdABpAG8AbgApACAAewB0AGgAcgBvAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAFMAdABvAHAAfQAKAAoAIAAgACAAIAAkAFAAcgBvAGcAcgBlAHMAcwAuAEsAaQBsAGwAKAApAAoACgB9ACAAYwBhAHQAYwBoACAAewAKACAAIAAgACAAJABQAHIAbwBnAHIAZQBzAHMALgBLAGkAbABsACgAKQAKACAAIAAgACAAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAKACAAIAAgACAAIAAgACAAIAAkAFIAZQBzAHUAbAB0AFsAMABdACwAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACwAMAAsACcARQByAHIAbwByACcALAAwACwAJwBEAGUAZgBhAHUAbAB0AEQAZQBzAGsAdABvAHAATwBuAGwAeQAnAAoAIAAgACAAIAApAAoAIAAgACAAIAByAGUAdAB1AHIAbgAKAH0ACgAKACMAIABVAHAAZABhAHQAZQAgAEYAaQBsAGUAIABFAHgAcABsAG8AcgBlAHIACgAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAIAA9ACAAVwByAGkAdABlAC0AVgBjAHMAUwB0AGEAdAB1AHMACgAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAIAA9ACAAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAfAAgAEYAbwByAEUAYQBjAGgALQBPAGIAagBlAGMAdAAgAHsAIAAkAF8AIAAtAHIAZQBwAGwAYQBjAGUAIAAnAFwAeAAxAGIAXABbAFsAMAAtADkAOwBdACoAbQAnACwAJwAnACAAfQAKACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAD0AIAAoAEcAZQB0AC0ARwBpAHQAUwB0AGEAdAB1AHMAKQAuAFIAZQBwAG8ATgBhAG0AZQAgACsAIAAnACAAJwAgACsAIAAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMACgAKAEEAZABkAC0AVAB5AHAAZQAgAC0ATgBhAG0AZQBzAHAAYQBjAGUAIABVAHQAaQBsACAALQBOAGEAbQBlACAAVwBpAG4AQQBwAGkAIAAgAC0ATQBlAG0AYgBlAHIARABlAGYAaQBuAGkAdABpAG8AbgAgAEAAIgAKACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgB1AHMAZQByADMAMgAuAGQAbABsACIAKQBdAAoAIAAgAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAARgBpAG4AZABXAGkAbgBkAG8AdwAoAHMAdAByAGkAbgBnACAAbABwAEMAbABhAHMAcwBOAGEAbQBlACwAIABzAHQAcgBpAG4AZwAgAGwAcABXAGkAbgBkAG8AdwBOAGEAbQBlACkAOwAKACIAQAAKAAoAJABoAHcAbgBkAFQAbwBwAE0AbwBzAHQARgBpAGwAZQBFAHgAcABsAG8AcgBlAHIAIAA9ACAAWwBVAHQAaQBsAC4AVwBpAG4AQQBwAGkAXQA6ADoARgBpAG4AZABXAGkAbgBkAG8AdwAoAAoAIAAgACIAQwBhAGIAaQBuAGUAdABXAEMAbABhAHMAcwAiACwAIAAgACAAIAAgACMAIAB0AGgAZQAgAHcAaQBuAGQAbwB3ACAAYwBsAGEAcwBzACAAbwBmACAAaQBuAHQAZQByAGUAcwB0AAoAIAAgAFsATgB1AGwAbABTAHQAcgBpAG4AZwBdADoAOgBWAGEAbAB1AGUAIAAgACMAIABuAG8AIAB3AGkAbgBkAG8AdwAgAHQAaQB0AGwAZQAgAHQAbwAgAHMAZQBhAHIAYwBoACAAZgBvAHIACgApAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAFQAeQBwAGUARABlAGYAaQBuAGkAdABpAG8AbgAgAEAAIgAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtADsACgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQAuAFIAdQBuAHQAaQBtAGUALgBJAG4AdABlAHIAbwBwAFMAZQByAHYAaQBjAGUAcwA7AAoACgBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAYwBsAGEAcwBzACAAVwBpAG4AMwAyACAAewAKACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBVAHMAZQByADMAMgAuAGQAbABsACIALAAgAEUAbgB0AHIAeQBQAG8AaQBuAHQAPQAiAFMAZQB0AFcAaQBuAGQAbwB3AFQAZQB4AHQAIgApAF0ACgAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAAaQBuAHQAIABTAGUAdABXAGkAbgBkAG8AdwBUAGUAeAB0ACgASQBuAHQAUAB0AHIAIABoAFcAbgBkACwAIABzAHQAcgBpAG4AZwAgAHMAdAByAFQAaQB0AGwAZQApADsACgB9AAoAIgBAAAoACgBbAFcAaQBuADMAMgBdADoAOgBTAGUAdABXAGkAbgBkAG8AdwBUAGUAeAB0ACgAJABoAHcAbgBkAFQAbwBwAE0AbwBzAHQARgBpAGwAZQBFAHgAcABsAG8AcgBlAHIALAAgACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwApAAoACgBbAFMAeQBzAHQAZQBtAC4AVwBpAG4AZABvAHcAcwAuAE0AZQBzAHMAYQBnAGUAQgBvAHgAXQA6ADoAUwBoAG8AdwAoAAoAIAAgACAAIAAkAFIAZQBzAHUAbAB0AFsAMABdACwAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACwAMAAsACcASQBuAGYAbwAnACwAMAAsACcARABlAGYAYQB1AGwAdABEAGUAcwBrAHQAbwBwAE8AbgBsAHkAJwAKACkA"
