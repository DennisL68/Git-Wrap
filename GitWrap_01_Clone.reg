Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\SOFTWARE\Classes\Directory\ContextMenus\GitWrap\shell\01_Clone\command]
; $cmd = @'
; # ------------
; # Clone Remote
; # ------------

; Add-Type -AssemblyName PresentationFramework

; # https://unicode.org/emoji/charts/full-emoji-list.html
; $CheckMark  = "`u{2714}"
; $CrossMark  = "`u{274C}"
; $Warning    = "`u{26A0}"
; $Prohibited = "`{1F6AB}"
; $BlackCircle = "`u{26AB}"
; $WhiteCircle = "`u{26AA}"
; $Triangle   = "`u{1F53A}"

; [void][Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic')
; $Repo = [Microsoft.VisualBasic.Interaction]::InputBox(
;     'Enter remote URI', 'Git for Windows' ,'[ENTER REMOTE REPO URI]'
; )

; $ProgressBlock = {
; [console]::WindowHeight = 2
; #[console]::BufferHeight = 2

; [console]::WindowWidth = 40
; [console]::BufferWidth = 40

; [console]::Title = 'GitWrap'

; while ($true) {
;     1..100 | foreach {
;         Write-Progress -Activity " Processing" -Status "`0" -PercentComplete $_
;         Start-Sleep -Milliseconds 50
;     }
; }
; }

; try {
;     $Progress = Start-Process PWSH "-noprofile -command $ProgressBlock" -PassThru

;     [string[]]$Result = git clone $Repo 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}
;     if (($Result | Select -Index 1) -like 'fatal:*') {
;         $Result[0] = $Result[1]
;         throw $Result
;     }

;     $Progress.Kill()

; } catch {
;     $Progress.Kill()

;     [System.Windows.MessageBox]::Show(#error
;         $Result[0],'Git for Windows',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; [System.Windows.MessageBox]::Show(#result
;     $Result[0],'Git for Windows',0,'Info',0,'DefaultDesktopOnly'
; )

; # Update File Explorer
; $ThisGitStatus = Write-VcsStatus
; $ThisGitStatus = $ThisGitStatus | ForEach-Object { $_ -replace '\x1b\[[0-9;]*m','' }
; $ThisGitStatus = $CheckMark + ' ' + (Get-GitStatus).RepoName + ' ' + $ThisGitStatus

; Add-Type -Namespace Util -Name WinApi  -MemberDefinition @"
;   [DllImport("user32.dll")]
;   public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
; "@

; $hwndTopMostFileExplorer = [Util.WinApi]::FindWindow(
;   "CabinetWClass",     # the window class of interest
;   [NullString]::Value  # no window title to search for
; )

; Add-Type -TypeDefinition @"
; using System;
; using System.Runtime.InteropServices;

; public static class Win32 {
;   [DllImport("User32.dll", CharSet=CharSet.Unicode, EntryPoint="SetWindowText")]
;   public static extern int SetWindowText(IntPtr hWnd, string strTitle);
; }
; "@

; # [Win32]::SetWindowText($hwndTopMostFileExplorer, $ThisGitStatus) # don't rename parent window

; '@
; [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($cmd))

@="pwsh.exe -WindowStyle hidden -EncodedCommand IwAgAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAAoAIwAgAEMAbABvAG4AZQAgAFIAZQBtAG8AdABlAAoAIwAgAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAEEAcwBzAGUAbQBiAGwAeQBOAGEAbQBlACAAUAByAGUAcwBlAG4AdABhAHQAaQBvAG4ARgByAGEAbQBlAHcAbwByAGsACgAKACMAIABoAHQAdABwAHMAOgAvAC8AdQBuAGkAYwBvAGQAZQAuAG8AcgBnAC8AZQBtAG8AagBpAC8AYwBoAGEAcgB0AHMALwBmAHUAbABsAC0AZQBtAG8AagBpAC0AbABpAHMAdAAuAGgAdABtAGwACgAkAEMAaABlAGMAawBNAGEAcgBrACAAIAA9ACAAIgBgAHUAewAyADcAMQA0AH0AIgAKACQAQwByAG8AcwBzAE0AYQByAGsAIAAgAD0AIAAiAGAAdQB7ADIANwA0AEMAfQAiAAoAJABXAGEAcgBuAGkAbgBnACAAIAAgACAAPQAgACIAYAB1AHsAMgA2AEEAMAB9ACIACgAkAFAAcgBvAGgAaQBiAGkAdABlAGQAIAA9ACAAIgBgAHsAMQBGADYAQQBCAH0AIgAKACQAQgBsAGEAYwBrAEMAaQByAGMAbABlACAAPQAgACIAYAB1AHsAMgA2AEEAQgB9ACIACgAkAFcAaABpAHQAZQBDAGkAcgBjAGwAZQAgAD0AIAAiAGAAdQB7ADIANgBBAEEAfQAiAAoAJABUAHIAaQBhAG4AZwBsAGUAIAAgACAAPQAgACIAYAB1AHsAMQBGADUAMwBBAH0AIgAKAAoAWwB2AG8AaQBkAF0AWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAVwBpAHQAaABQAGEAcgB0AGkAYQBsAE4AYQBtAGUAKAAnAE0AaQBjAHIAbwBzAG8AZgB0AC4AVgBpAHMAdQBhAGwAQgBhAHMAaQBjACcAKQAKACQAUgBlAHAAbwAgAD0AIABbAE0AaQBjAHIAbwBzAG8AZgB0AC4AVgBpAHMAdQBhAGwAQgBhAHMAaQBjAC4ASQBuAHQAZQByAGEAYwB0AGkAbwBuAF0AOgA6AEkAbgBwAHUAdABCAG8AeAAoAAoAIAAgACAAIAAnAEUAbgB0AGUAcgAgAHIAZQBtAG8AdABlACAAVQBSAEkAJwAsACAAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACAALAAnAFsARQBOAFQARQBSACAAUgBFAE0ATwBUAEUAIABSAEUAUABPACAAVQBSAEkAXQAnAAoAKQAKAAoAJABQAHIAbwBnAHIAZQBzAHMAQgBsAG8AYwBrACAAPQAgAHsACgBbAGMAbwBuAHMAbwBsAGUAXQA6ADoAVwBpAG4AZABvAHcASABlAGkAZwBoAHQAIAA9ACAAMgAKACMAWwBjAG8AbgBzAG8AbABlAF0AOgA6AEIAdQBmAGYAZQByAEgAZQBpAGcAaAB0ACAAPQAgADIACgAKAFsAYwBvAG4AcwBvAGwAZQBdADoAOgBXAGkAbgBkAG8AdwBXAGkAZAB0AGgAIAA9ACAANAAwAAoAWwBjAG8AbgBzAG8AbABlAF0AOgA6AEIAdQBmAGYAZQByAFcAaQBkAHQAaAAgAD0AIAA0ADAACgAKAFsAYwBvAG4AcwBvAGwAZQBdADoAOgBUAGkAdABsAGUAIAA9ACAAJwBHAGkAdABXAHIAYQBwACcACgAKAHcAaABpAGwAZQAgACgAJAB0AHIAdQBlACkAIAB7AAoAIAAgACAAIAAxAC4ALgAxADAAMAAgAHwAIABmAG8AcgBlAGEAYwBoACAAewAKACAAIAAgACAAIAAgACAAIABXAHIAaQB0AGUALQBQAHIAbwBnAHIAZQBzAHMAIAAtAEEAYwB0AGkAdgBpAHQAeQAgACIAIABQAHIAbwBjAGUAcwBzAGkAbgBnACIAIAAtAFMAdABhAHQAdQBzACAAIgBgADAAIgAgAC0AUABlAHIAYwBlAG4AdABDAG8AbQBwAGwAZQB0AGUAIAAkAF8ACgAgACAAIAAgACAAIAAgACAAUwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBNAGkAbABsAGkAcwBlAGMAbwBuAGQAcwAgADUAMAAKACAAIAAgACAAfQAKAH0ACgB9AAoACgB0AHIAeQAgAHsACgAgACAAIAAgACQAUAByAG8AZwByAGUAcwBzACAAPQAgAFMAdABhAHIAdAAtAFAAcgBvAGMAZQBzAHMAIABQAFcAUwBIACAAIgAtAG4AbwBwAHIAbwBmAGkAbABlACAALQBjAG8AbQBtAGEAbgBkACAAJABQAHIAbwBnAHIAZQBzAHMAQgBsAG8AYwBrACIAIAAtAFAAYQBzAHMAVABoAHIAdQAKAAoAIAAgACAAIABbAHMAdAByAGkAbgBnAFsAXQBdACQAUgBlAHMAdQBsAHQAIAA9ACAAZwBpAHQAIABjAGwAbwBuAGUAIAAkAFIAZQBwAG8AIAAyAD4AJgAxAAoAIAAgACAAIABpAGYAIAAoACQAUgBlAHMAdQBsAHQALgBFAHgAYwBlAHAAdABpAG8AbgApACAAewB0AGgAcgBvAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAFMAdABvAHAAfQAKACAAIAAgACAAaQBmACAAKAAoACQAUgBlAHMAdQBsAHQAIAB8ACAAUwBlAGwAZQBjAHQAIAAtAEkAbgBkAGUAeAAgADEAKQAgAC0AbABpAGsAZQAgACcAZgBhAHQAYQBsADoAKgAnACkAIAB7AAoAIAAgACAAIAAgACAAIAAgACQAUgBlAHMAdQBsAHQAWwAwAF0AIAA9ACAAJABSAGUAcwB1AGwAdABbADEAXQAKACAAIAAgACAAIAAgACAAIAB0AGgAcgBvAHcAIAAkAFIAZQBzAHUAbAB0AAoAIAAgACAAIAB9AAoACgAgACAAIAAgACQAUAByAG8AZwByAGUAcwBzAC4ASwBpAGwAbAAoACkACgAKAH0AIABjAGEAdABjAGgAIAB7AAoAIAAgACAAIAAkAFAAcgBvAGcAcgBlAHMAcwAuAEsAaQBsAGwAKAApAAoACgAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgAIwBlAHIAcgBvAHIACgAgACAAIAAgACAAIAAgACAAJABSAGUAcwB1AGwAdABbADAAXQAsACcARwBpAHQAIABmAG8AcgAgAFcAaQBuAGQAbwB3AHMAJwAsADAALAAnAEUAcgByAG8AcgAnACwAMAAsACcARABlAGYAYQB1AGwAdABEAGUAcwBrAHQAbwBwAE8AbgBsAHkAJwAKACAAIAAgACAAKQAKACAAIAAgACAAcgBlAHQAdQByAG4ACgB9AAoACgBbAFMAeQBzAHQAZQBtAC4AVwBpAG4AZABvAHcAcwAuAE0AZQBzAHMAYQBnAGUAQgBvAHgAXQA6ADoAUwBoAG8AdwAoACMAcgBlAHMAdQBsAHQACgAgACAAIAAgACQAUgBlAHMAdQBsAHQAWwAwAF0ALAAnAEcAaQB0ACAAZgBvAHIAIABXAGkAbgBkAG8AdwBzACcALAAwACwAJwBJAG4AZgBvACcALAAwACwAJwBEAGUAZgBhAHUAbAB0AEQAZQBzAGsAdABvAHAATwBuAGwAeQAnAAoAKQAKAAoAIwAgAFUAcABkAGEAdABlACAARgBpAGwAZQAgAEUAeABwAGwAbwByAGUAcgAKACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAD0AIABXAHIAaQB0AGUALQBWAGMAcwBTAHQAYQB0AHUAcwAKACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAD0AIAAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAIAB8ACAARgBvAHIARQBhAGMAaAAtAE8AYgBqAGUAYwB0ACAAewAgACQAXwAgAC0AcgBlAHAAbABhAGMAZQAgACcAXAB4ADEAYgBcAFsAWwAwAC0AOQA7AF0AKgBtACcALAAnACcAIAB9AAoAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAPQAgACQAQwBoAGUAYwBrAE0AYQByAGsAIAArACAAJwAgACcAIAArACAAKABHAGUAdAAtAEcAaQB0AFMAdABhAHQAdQBzACkALgBSAGUAcABvAE4AYQBtAGUAIAArACAAJwAgACcAIAArACAAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAE4AYQBtAGUAcwBwAGEAYwBlACAAVQB0AGkAbAAgAC0ATgBhAG0AZQAgAFcAaQBuAEEAcABpACAAIAAtAE0AZQBtAGIAZQByAEQAZQBmAGkAbgBpAHQAaQBvAG4AIABAACIACgAgACAAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAdQBzAGUAcgAzADIALgBkAGwAbAAiACkAXQAKACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAEYAaQBuAGQAVwBpAG4AZABvAHcAKABzAHQAcgBpAG4AZwAgAGwAcABDAGwAYQBzAHMATgBhAG0AZQAsACAAcwB0AHIAaQBuAGcAIABsAHAAVwBpAG4AZABvAHcATgBhAG0AZQApADsACgAiAEAACgAKACQAaAB3AG4AZABUAG8AcABNAG8AcwB0AEYAaQBsAGUARQB4AHAAbABvAHIAZQByACAAPQAgAFsAVQB0AGkAbAAuAFcAaQBuAEEAcABpAF0AOgA6AEYAaQBuAGQAVwBpAG4AZABvAHcAKAAKACAAIAAiAEMAYQBiAGkAbgBlAHQAVwBDAGwAYQBzAHMAIgAsACAAIAAgACAAIAAjACAAdABoAGUAIAB3AGkAbgBkAG8AdwAgAGMAbABhAHMAcwAgAG8AZgAgAGkAbgB0AGUAcgBlAHMAdAAKACAAIABbAE4AdQBsAGwAUwB0AHIAaQBuAGcAXQA6ADoAVgBhAGwAdQBlACAAIAAjACAAbgBvACAAdwBpAG4AZABvAHcAIAB0AGkAdABsAGUAIAB0AG8AIABzAGUAYQByAGMAaAAgAGYAbwByAAoAKQAKAAoAQQBkAGQALQBUAHkAcABlACAALQBUAHkAcABlAEQAZQBmAGkAbgBpAHQAaQBvAG4AIABAACIACgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQA7AAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBSAHUAbgB0AGkAbQBlAC4ASQBuAHQAZQByAG8AcABTAGUAcgB2AGkAYwBlAHMAOwAKAAoAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGMAbABhAHMAcwAgAFcAaQBuADMAMgAgAHsACgAgACAAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAVQBzAGUAcgAzADIALgBkAGwAbAAiACwAIABDAGgAYQByAFMAZQB0AD0AQwBoAGEAcgBTAGUAdAAuAFUAbgBpAGMAbwBkAGUALAAgAEUAbgB0AHIAeQBQAG8AaQBuAHQAPQAiAFMAZQB0AFcAaQBuAGQAbwB3AFQAZQB4AHQAIgApAF0ACgAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAAaQBuAHQAIABTAGUAdABXAGkAbgBkAG8AdwBUAGUAeAB0ACgASQBuAHQAUAB0AHIAIABoAFcAbgBkACwAIABzAHQAcgBpAG4AZwAgAHMAdAByAFQAaQB0AGwAZQApADsACgB9AAoAIgBAAAoACgAjACAAWwBXAGkAbgAzADIAXQA6ADoAUwBlAHQAVwBpAG4AZABvAHcAVABlAHgAdAAoACQAaAB3AG4AZABUAG8AcABNAG8AcwB0AEYAaQBsAGUARQB4AHAAbABvAHIAZQByACwAIAAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAKQAgACMAIABkAG8AbgAnAHQAIAByAGUAbgBhAG0AZQAgAHAAYQByAGUAbgB0ACAAdwBpAG4AZABvAHcACgA="
