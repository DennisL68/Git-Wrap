Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\SOFTWARE\Classes\Directory\ContextMenus\GitWrap\shell\10_Commit\command]
; $cmd = @'
; # -------------------
; # Conventional Commit
; # -------------------

; Add-Type -AssemblyName PresentationFramework

; # https://unicode.org/emoji/charts/full-emoji-list.html
; $CheckMark  = "`u{2714}"
; $CrossMark  = "`u{274C}"
; $Warning    = "`u{26A0}"
; $Prohibited = "`{1F6AB}"
; $BlackCircle = "`u{26AB}"
; $WhiteCircle = "`u{26AA}"
; $Triangle   = "`u{1F53A}"

; $CommitChoices = @"
; [
;     {
;         "type":"feat",
;         "description":"added new function/feature/textpart"
;     },
;     {
;         "type":"refact",
;         "description":"changed code/text that doesn't change the outcome/meaning"
;     },
;     {
;         "type":"fix",
;         "description":"fixed a bug or a typo"
;     },
;     {
;         "type":"docs",
;         "description":"managed/wrote documents, help, instructions etc."
;     },
;     {
;         "type":"chore",
;         "description":"other change that doesn't alter meaning/functionality"
;     },
;     {
;         "type":"test",
;         "description":"described how to perform a test or wrote code for testing"
;     }
; ]
; "@ | ConvertFrom-Json

; try {
;     $CommitType = $CommitChoices | Out-GridView -Title 'Git for Windows - Store State [SELECT COMMIT TYPE]' -OutputMode Single
;     if (
;         !$CommitType -or
;         ($CommitType | Select -ExpandProperty Type) -eq ''
;     ) {throw}

;     $ConventionalCommit = $CommitType.Type + '(ref):'
; } catch {
;     [System.Windows.MessageBox]::Show(
;         'Error in parameter input','Git for Windows',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }
 
; try {
;     [string[]]$Result = git status 2>&1
;     if ($Result.Exception) {throw}

;     [string[]]$Result = git add . 2>&1
;     if ($Result.Exception) {throw}

;     [string[]]$Result = git commit -m"$ConventionalCommit" 2>&1
;     if ($Result.Exception) {throw}
;     if (($Result | Select -Last 1) -like 'nothing to commit*') {
;         $Result[0] = $Result[-1]
;         throw
;     }

;     [string[]]$Result = git commit --amend 2>&1
;     if (
;         $Result.Exception -and
;         $Result[0].Exception -notlike "*unix2dos*"
;     ) {throw}

; } catch {
;     [System.Windows.MessageBox]::Show(
;         $Result[0],'Git for Windows',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; # Update File Explorer
; $ThisGitStatus = Write-VcsStatus
; $ThisGitStatus = $ThisGitStatus | ForEach-Object { $_ -replace '\x1b\[[0-9;]*m','' } #clean out ANSI
; $ThisGitStatus = $CheckMark + ' ' + (Get-GitStatus).RepoName + ' ' + $ThisGitStatus

; Add-Type -Namespace Util -Name WinApi  -MemberDefinition @"
;   [DllImport("user32.dll")]
;   public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
; "@

; $hwndTopMostFileExplorer = [Util.WinApi]::FindWindow(
;   "CabinetWClass",     # the window class of interest
;   [NullString]::Value  # no window title to search for
; )

; Add-Type -TypeDefinition @"
; using System;
; using System.Runtime.InteropServices;

; public static class Win32 {
;   [DllImport("User32.dll", CharSet=CharSet.Unicode, EntryPoint="SetWindowText")]
;   public static extern int SetWindowText(IntPtr hWnd, string strTitle);
; }
; "@

; [Win32]::SetWindowText($hwndTopMostFileExplorer, $ThisGitStatus)

; [System.Windows.MessageBox]::Show(
;     $Result[0],'Git for Windows',0,'Info',0,'DefaultDesktopOnly'
; )
; '@
; [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($cmd))

@="pwsh.exe -WindowStyle hidden -EncodedCommand IwAgAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAKACMAIABDAG8AbQBtAGkAdAAgAGYAZQBhAHQACgAjACAALQAtAC0ALQAtAC0ALQAtAC0ALQAtAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAEEAcwBzAGUAbQBiAGwAeQBOAGEAbQBlACAAUAByAGUAcwBlAG4AdABhAHQAaQBvAG4ARgByAGEAbQBlAHcAbwByAGsACgAKACMAIABoAHQAdABwAHMAOgAvAC8AdQBuAGkAYwBvAGQAZQAuAG8AcgBnAC8AZQBtAG8AagBpAC8AYwBoAGEAcgB0AHMALwBmAHUAbABsAC0AZQBtAG8AagBpAC0AbABpAHMAdAAuAGgAdABtAGwACgAkAEMAaABlAGMAawBNAGEAcgBrACAAIAA9ACAAIgBgAHUAewAyADcAMQA0AH0AIgAKACQAQwByAG8AcwBzAE0AYQByAGsAIAAgAD0AIAAiAGAAdQB7ADIANwA0AEMAfQAiAAoAJABXAGEAcgBuAGkAbgBnACAAIAAgACAAPQAgACIAYAB1AHsAMgA2AEEAMAB9ACIACgAkAFAAcgBvAGgAaQBiAGkAdABlAGQAIAA9ACAAIgBgAHsAMQBGADYAQQBCAH0AIgAKACQAQgBsAGEAYwBrAEMAaQByAGMAbABlACAAPQAgACIAYAB1AHsAMgA2AEEAQgB9ACIACgAkAFcAaABpAHQAZQBDAGkAcgBjAGwAZQAgAD0AIAAiAGAAdQB7ADIANgBBAEEAfQAiAAoAJABUAHIAaQBhAG4AZwBsAGUAIAAgACAAPQAgACIAYAB1AHsAMQBGADUAMwBBAH0AIgAKAAoAJABDAG8AbQBtAGkAdABDAGgAbwBpAGMAZQBzACAAPQAgAEAAIgAKAFsACgAgACAAIAAgAHsACgAgACAAIAAgACAAIAAgACAAIgB0AHkAcABlACIAOgAiAGYAZQBhAHQAIgAsAAoAIAAgACAAIAAgACAAIAAgACIAZABlAHMAYwByAGkAcAB0AGkAbwBuACIAOgAiAGEAZABkAGUAZAAgAG4AZQB3ACAAZgB1AG4AYwB0AGkAbwBuAC8AZgBlAGEAdAB1AHIAZQAvAHQAZQB4AHQAcABhAHIAdAAiAAoAIAAgACAAIAB9ACwACgAgACAAIAAgAHsACgAgACAAIAAgACAAIAAgACAAIgB0AHkAcABlACIAOgAiAHIAZQBmAGEAYwB0ACIALAAKACAAIAAgACAAIAAgACAAIAAiAGQAZQBzAGMAcgBpAHAAdABpAG8AbgAiADoAIgBjAGgAYQBuAGcAZQBkACAAYwBvAGQAZQAvAHQAZQB4AHQAIAB0AGgAYQB0ACAAZABvAGUAcwBuACcAdAAgAGMAaABhAG4AZwBlACAAdABoAGUAIABvAHUAdABjAG8AbQBlAC8AbQBlAGEAbgBpAG4AZwAiAAoAIAAgACAAIAB9ACwACgAgACAAIAAgAHsACgAgACAAIAAgACAAIAAgACAAIgB0AHkAcABlACIAOgAiAGYAaQB4ACIALAAKACAAIAAgACAAIAAgACAAIAAiAGQAZQBzAGMAcgBpAHAAdABpAG8AbgAiADoAIgBmAGkAeABlAGQAIABhACAAYgB1AGcAIABvAHIAIABhACAAdAB5AHAAbwAiAAoAIAAgACAAIAB9ACwACgAgACAAIAAgAHsACgAgACAAIAAgACAAIAAgACAAIgB0AHkAcABlACIAOgAiAGQAbwBjAHMAIgAsAAoAIAAgACAAIAAgACAAIAAgACIAZABlAHMAYwByAGkAcAB0AGkAbwBuACIAOgAiAG0AYQBuAGEAZwBlAGQALwB3AHIAbwB0AGUAIABkAG8AYwB1AG0AZQBuAHQAcwAsACAAaABlAGwAcAAsACAAaQBuAHMAdAByAHUAYwB0AGkAbwBuAHMAIABlAHQAYwAuACIACgAgACAAIAAgAH0ALAAKACAAIAAgACAAewAKACAAIAAgACAAIAAgACAAIAAiAHQAeQBwAGUAIgA6ACIAYwBoAG8AcgBlACIALAAKACAAIAAgACAAIAAgACAAIAAiAGQAZQBzAGMAcgBpAHAAdABpAG8AbgAiADoAIgBvAHQAaABlAHIAIABjAGgAYQBuAGcAZQAgAHQAaABhAHQAIABkAG8AZQBzAG4AJwB0ACAAYQBsAHQAZQByACAAbQBlAGEAbgBpAG4AZwAvAGYAdQBuAGMAdABpAG8AbgBhAGwAaQB0AHkAIgAKACAAIAAgACAAfQAsAAoAIAAgACAAIAB7AAoAIAAgACAAIAAgACAAIAAgACIAdAB5AHAAZQAiADoAIgB0AGUAcwB0ACIALAAKACAAIAAgACAAIAAgACAAIAAiAGQAZQBzAGMAcgBpAHAAdABpAG8AbgAiADoAIgBkAGUAcwBjAHIAaQBiAGUAZAAgAGgAbwB3ACAAdABvACAAcABlAHIAZgBvAHIAbQAgAGEAIAB0AGUAcwB0ACAAbwByACAAdwByAG8AdABlACAAYwBvAGQAZQAgAGYAbwByACAAdABlAHMAdABpAG4AZwAiAAoAIAAgACAAIAB9AAoAXQAKACIAQAAgAHwAIABDAG8AbgB2AGUAcgB0AEYAcgBvAG0ALQBKAHMAbwBuAAoACgB0AHIAeQAgAHsACgAgACAAIAAgACQAQwBvAG0AbQBpAHQAVAB5AHAAZQAgAD0AIAAkAEMAbwBtAG0AaQB0AEMAaABvAGkAYwBlAHMAIAB8ACAATwB1AHQALQBHAHIAaQBkAFYAaQBlAHcAIAAtAFQAaQB0AGwAZQAgACcARwBpAHQAIABmAG8AcgAgAFcAaQBuAGQAbwB3AHMAIAAtACAAUwB0AG8AcgBlACAAUwB0AGEAdABlACAAWwBTAEUATABFAEMAVAAgAEMATwBNAE0ASQBUACAAVABZAFAARQBdACcAIAAtAE8AdQB0AHAAdQB0AE0AbwBkAGUAIABTAGkAbgBnAGwAZQAKACAAIAAgACAAaQBmACAAKAAKACAAIAAgACAAIAAgACAAIAAhACQAQwBvAG0AbQBpAHQAVAB5AHAAZQAgAC0AbwByAAoAIAAgACAAIAAgACAAIAAgACgAJABDAG8AbQBtAGkAdABUAHkAcABlACAAfAAgAFMAZQBsAGUAYwB0ACAALQBFAHgAcABhAG4AZABQAHIAbwBwAGUAcgB0AHkAIABUAHkAcABlACkAIAAtAGUAcQAgACcAJwAKACAAIAAgACAAKQAgAHsAdABoAHIAbwB3AH0ACgAKACAAIAAgACAAJABDAG8AbgB2AGUAbgB0AGkAbwBuAGEAbABDAG8AbQBtAGkAdAAgAD0AIAAkAEMAbwBtAG0AaQB0AFQAeQBwAGUALgBUAHkAcABlACAAKwAgACcAKAByAGUAZgApADoAJwAKAH0AIABjAGEAdABjAGgAIAB7AAoAIAAgACAAIABbAFMAeQBzAHQAZQBtAC4AVwBpAG4AZABvAHcAcwAuAE0AZQBzAHMAYQBnAGUAQgBvAHgAXQA6ADoAUwBoAG8AdwAoAAoAIAAgACAAIAAgACAAIAAgACcARQByAHIAbwByACAAaQBuACAAcABhAHIAYQBtAGUAdABlAHIAIABpAG4AcAB1AHQAJwAsACcARwBpAHQAIABmAG8AcgAgAFcAaQBuAGQAbwB3AHMAJwAsADAALAAnAEUAcgByAG8AcgAnACwAMAAsACcARABlAGYAYQB1AGwAdABEAGUAcwBrAHQAbwBwAE8AbgBsAHkAJwAKACAAIAAgACAAKQAKACAAIAAgACAAcgBlAHQAdQByAG4ACgB9AAoAIAAKAHQAcgB5ACAAewAKACAAIAAgACAAWwBzAHQAcgBpAG4AZwBbAF0AXQAkAFIAZQBzAHUAbAB0ACAAPQAgAGcAaQB0ACAAcwB0AGEAdAB1AHMAIAAyAD4AJgAxAAoAIAAgACAAIABpAGYAIAAoACQAUgBlAHMAdQBsAHQALgBFAHgAYwBlAHAAdABpAG8AbgApACAAewB0AGgAcgBvAHcAfQAKAAoAIAAgACAAIABbAHMAdAByAGkAbgBnAFsAXQBdACQAUgBlAHMAdQBsAHQAIAA9ACAAZwBpAHQAIABhAGQAZAAgAC4AIAAyAD4AJgAxAAoAIAAgACAAIABpAGYAIAAoACQAUgBlAHMAdQBsAHQALgBFAHgAYwBlAHAAdABpAG8AbgApACAAewB0AGgAcgBvAHcAfQAKAAoAIAAgACAAIABbAHMAdAByAGkAbgBnAFsAXQBdACQAUgBlAHMAdQBsAHQAIAA9ACAAZwBpAHQAIABjAG8AbQBtAGkAdAAgAC0AbQAiACQAQwBvAG4AdgBlAG4AdABpAG8AbgBhAGwAQwBvAG0AbQBpAHQAIgAgADIAPgAmADEACgAgACAAIAAgAGkAZgAgACgAJABSAGUAcwB1AGwAdAAuAEUAeABjAGUAcAB0AGkAbwBuACkAIAB7AHQAaAByAG8AdwB9AAoAIAAgACAAIABpAGYAIAAoACgAJABSAGUAcwB1AGwAdAAgAHwAIABTAGUAbABlAGMAdAAgAC0ATABhAHMAdAAgADEAKQAgAC0AbABpAGsAZQAgACcAbgBvAHQAaABpAG4AZwAgAHQAbwAgAGMAbwBtAG0AaQB0ACoAJwApACAAewAKACAAIAAgACAAIAAgACAAIAAkAFIAZQBzAHUAbAB0AFsAMABdACAAPQAgACQAUgBlAHMAdQBsAHQAWwAtADEAXQAKACAAIAAgACAAIAAgACAAIAB0AGgAcgBvAHcACgAgACAAIAAgAH0ACgAKACAAIAAgACAAWwBzAHQAcgBpAG4AZwBbAF0AXQAkAFIAZQBzAHUAbAB0ACAAPQAgAGcAaQB0ACAAYwBvAG0AbQBpAHQAIAAtAC0AYQBtAGUAbgBkACAAMgA+ACYAMQAKACAAIAAgACAAaQBmACAAKAAKACAAIAAgACAAIAAgACAAIAAkAFIAZQBzAHUAbAB0AC4ARQB4AGMAZQBwAHQAaQBvAG4AIAAtAGEAbgBkAAoAIAAgACAAIAAgACAAIAAgACQAUgBlAHMAdQBsAHQAWwAwAF0ALgBFAHgAYwBlAHAAdABpAG8AbgAgAC0AbgBvAHQAbABpAGsAZQAgACIAKgB1AG4AaQB4ADIAZABvAHMAKgAiAAoAIAAgACAAIAApACAAewB0AGgAcgBvAHcAfQAKAAoAfQAgAGMAYQB0AGMAaAAgAHsACgAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgACgAgACAAIAAgACAAIAAgACAAJABSAGUAcwB1AGwAdABbADAAXQAsACcARwBpAHQAIABmAG8AcgAgAFcAaQBuAGQAbwB3AHMAJwAsADAALAAnAEUAcgByAG8AcgAnACwAMAAsACcARABlAGYAYQB1AGwAdABEAGUAcwBrAHQAbwBwAE8AbgBsAHkAJwAKACAAIAAgACAAKQAKACAAIAAgACAAcgBlAHQAdQByAG4ACgB9AAoACgAjACAAVQBwAGQAYQB0AGUAIABGAGkAbABlACAARQB4AHAAbABvAHIAZQByAAoAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAPQAgAFcAcgBpAHQAZQAtAFYAYwBzAFMAdABhAHQAdQBzAAoAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAPQAgACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAHwAIABGAG8AcgBFAGEAYwBoAC0ATwBiAGoAZQBjAHQAIAB7ACAAJABfACAALQByAGUAcABsAGEAYwBlACAAJwBcAHgAMQBiAFwAWwBbADAALQA5ADsAXQAqAG0AJwAsACcAJwAgAH0AIAAjAGMAbABlAGEAbgAgAG8AdQB0ACAAQQBOAFMASQAKACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAD0AIAAkAEMAaABlAGMAawBNAGEAcgBrACAAKwAgACcAIAAnACAAKwAgACgARwBlAHQALQBHAGkAdABTAHQAYQB0AHUAcwApAC4AUgBlAHAAbwBOAGEAbQBlACAAKwAgACcAIAAnACAAKwAgACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAKAAoAQQBkAGQALQBUAHkAcABlACAALQBOAGEAbQBlAHMAcABhAGMAZQAgAFUAdABpAGwAIAAtAE4AYQBtAGUAIABXAGkAbgBBAHAAaQAgACAALQBNAGUAbQBiAGUAcgBEAGUAZgBpAG4AaQB0AGkAbwBuACAAQAAiAAoAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAHUAcwBlAHIAMwAyAC4AZABsAGwAIgApAF0ACgAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABGAGkAbgBkAFcAaQBuAGQAbwB3ACgAcwB0AHIAaQBuAGcAIABsAHAAQwBsAGEAcwBzAE4AYQBtAGUALAAgAHMAdAByAGkAbgBnACAAbABwAFcAaQBuAGQAbwB3AE4AYQBtAGUAKQA7AAoAIgBAAAoACgAkAGgAdwBuAGQAVABvAHAATQBvAHMAdABGAGkAbABlAEUAeABwAGwAbwByAGUAcgAgAD0AIABbAFUAdABpAGwALgBXAGkAbgBBAHAAaQBdADoAOgBGAGkAbgBkAFcAaQBuAGQAbwB3ACgACgAgACAAIgBDAGEAYgBpAG4AZQB0AFcAQwBsAGEAcwBzACIALAAgACAAIAAgACAAIwAgAHQAaABlACAAdwBpAG4AZABvAHcAIABjAGwAYQBzAHMAIABvAGYAIABpAG4AdABlAHIAZQBzAHQACgAgACAAWwBOAHUAbABsAFMAdAByAGkAbgBnAF0AOgA6AFYAYQBsAHUAZQAgACAAIwAgAG4AbwAgAHcAaQBuAGQAbwB3ACAAdABpAHQAbABlACAAdABvACAAcwBlAGEAcgBjAGgAIABmAG8AcgAKACkACgAKAEEAZABkAC0AVAB5AHAAZQAgAC0AVAB5AHAAZQBEAGUAZgBpAG4AaQB0AGkAbwBuACAAQAAiAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0AOwAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtAC4AUgB1AG4AdABpAG0AZQAuAEkAbgB0AGUAcgBvAHAAUwBlAHIAdgBpAGMAZQBzADsACgAKAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABjAGwAYQBzAHMAIABXAGkAbgAzADIAIAB7AAoAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAFUAcwBlAHIAMwAyAC4AZABsAGwAIgAsACAAQwBoAGEAcgBTAGUAdAA9AEMAaABhAHIAUwBlAHQALgBVAG4AaQBjAG8AZABlACwAIABFAG4AdAByAHkAUABvAGkAbgB0AD0AIgBTAGUAdABXAGkAbgBkAG8AdwBUAGUAeAB0ACIAKQBdAAoAIAAgAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAGkAbgB0ACAAUwBlAHQAVwBpAG4AZABvAHcAVABlAHgAdAAoAEkAbgB0AFAAdAByACAAaABXAG4AZAAsACAAcwB0AHIAaQBuAGcAIABzAHQAcgBUAGkAdABsAGUAKQA7AAoAfQAKACIAQAAKAAoAWwBXAGkAbgAzADIAXQA6ADoAUwBlAHQAVwBpAG4AZABvAHcAVABlAHgAdAAoACQAaAB3AG4AZABUAG8AcABNAG8AcwB0AEYAaQBsAGUARQB4AHAAbABvAHIAZQByACwAIAAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAKQAKAAoAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAKACAAIAAgACAAJABSAGUAcwB1AGwAdABbADAAXQAsACcARwBpAHQAIABmAG8AcgAgAFcAaQBuAGQAbwB3AHMAJwAsADAALAAnAEkAbgBmAG8AJwAsADAALAAnAEQAZQBmAGEAdQBsAHQARABlAHMAawB0AG8AcABPAG4AbAB5ACcACgApAA=="
