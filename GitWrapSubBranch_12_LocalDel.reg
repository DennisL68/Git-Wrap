Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\SOFTWARE\Classes\Directory\ContextMenus\GitWrap\GitWrapSub_Branch\shell\12_LocalDel\command]
; $cmd = @'
; ###############
; # Delete Branch
; ###############

; try {
;     [string[]]$Result = git branch -l 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}

; } catch {
;     [System.Windows.MessageBox]::Show($Result[0],'Git for Windows',0,'Error')
;     return
; }

; $Branches = $Result

; try {
;     $Branch = $Branches | Out-GridView -Title 'Git for Windows - Delete Branch [SELECT BRANCH]' -OutputMode Single
;     if (!$Branch) {throw -ErrorAction stop}

; } catch {
;     [System.Windows.MessageBox]::Show('Error in parameter input','Git for Windows',0,'Error')
;     return
; }

; try {
;     [string[]]$Result = git branch -d $Branch.SubString(2) 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}
;     if (
;         $Result -like "fatal*" -or
;         $Result -like "error*"
;     ) {throw -ErrorAction Stop}

; } catch {
;     [System.Windows.MessageBox]::Show($Result[0],'Git for Windows',0,'Error')
;     return
; }

; # Update File Explorer
; $ThisGitStatus = Write-VcsStatus
; $ThisGitStatus = $ThisGitStatus | ForEach-Object { $_ -replace '\x1b\[[0-9;]*m','' }
; $ThisGitStatus = (Get-GitStatus).RepoName + ' ' + $ThisGitStatus

; Add-Type -Namespace Util -Name WinApi  -MemberDefinition @"
;   [DllImport("user32.dll")]
;   public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
; "@

; $hwndTopMostFileExplorer = [Util.WinApi]::FindWindow(
;   "CabinetWClass",     # the window class of interest
;   [NullString]::Value  # no window title to search for
; )

; Add-Type -TypeDefinition @"
; using System;
; using System.Runtime.InteropServices;

; public static class Win32 {
;   [DllImport("User32.dll", EntryPoint="SetWindowText")]
;   public static extern int SetWindowText(IntPtr hWnd, string strTitle);
; }
; "@

; [Win32]::SetWindowText($hwndTopMostFileExplorer, $ThisGitStatus)

; [System.Windows.MessageBox]::Show($Result[0],'Git for Windows',0,'Info')
; '@
; [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($cmd))

@="pwsh.exe -WindowStyle hidden -EncodedCommand IwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMACgAjACAARABlAGwAZQB0AGUAIABCAHIAYQBuAGMAaAAKACMAIwAjACMAIwAjACMAIwAjACMAIwAjACMAIwAjAAoACgB0AHIAeQAgAHsACgAgACAAIAAgAFsAcwB0AHIAaQBuAGcAWwBdAF0AJABSAGUAcwB1AGwAdAAgAD0AIABnAGkAdAAgAGIAcgBhAG4AYwBoACAALQBsACAAMgA+ACYAMQAKACAAIAAgACAAaQBmACAAKAAkAFIAZQBzAHUAbAB0AC4ARQB4AGMAZQBwAHQAaQBvAG4AKQAgAHsAdABoAHIAbwB3ACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAHQAbwBwAH0ACgAKAH0AIABjAGEAdABjAGgAIAB7AAoAIAAgACAAIABbAFMAeQBzAHQAZQBtAC4AVwBpAG4AZABvAHcAcwAuAE0AZQBzAHMAYQBnAGUAQgBvAHgAXQA6ADoAUwBoAG8AdwAoACQAUgBlAHMAdQBsAHQAWwAwAF0ALAAnAEcAaQB0ACAAZgBvAHIAIABXAGkAbgBkAG8AdwBzACcALAAwACwAJwBFAHIAcgBvAHIAJwApAAoAIAAgACAAIAByAGUAdAB1AHIAbgAKAH0ACgAKACQAQgByAGEAbgBjAGgAZQBzACAAPQAgACQAUgBlAHMAdQBsAHQACgAKAHQAcgB5ACAAewAKACAAIAAgACAAJABCAHIAYQBuAGMAaAAgAD0AIAAkAEIAcgBhAG4AYwBoAGUAcwAgAHwAIABPAHUAdAAtAEcAcgBpAGQAVgBpAGUAdwAgAC0AVABpAHQAbABlACAAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAgAC0AIABEAGUAbABlAHQAZQAgAEIAcgBhAG4AYwBoACAAWwBTAEUATABFAEMAVAAgAEIAUgBBAE4AQwBIAF0AJwAgAC0ATwB1AHQAcAB1AHQATQBvAGQAZQAgAFMAaQBuAGcAbABlAAoAIAAgACAAIABpAGYAIAAoACEAJABCAHIAYQBuAGMAaAApACAAewB0AGgAcgBvAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAHMAdABvAHAAfQAKAAoAfQAgAGMAYQB0AGMAaAAgAHsACgAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgAJwBFAHIAcgBvAHIAIABpAG4AIABwAGEAcgBhAG0AZQB0AGUAcgAgAGkAbgBwAHUAdAAnACwAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACwAMAAsACcARQByAHIAbwByACcAKQAKACAAIAAgACAAcgBlAHQAdQByAG4ACgB9AAoACgB0AHIAeQAgAHsACgAgACAAIAAgAFsAcwB0AHIAaQBuAGcAWwBdAF0AJABSAGUAcwB1AGwAdAAgAD0AIABnAGkAdAAgAGIAcgBhAG4AYwBoACAALQBkACAAJABCAHIAYQBuAGMAaAAuAFMAdQBiAFMAdAByAGkAbgBnACgAMgApACAAMgA+ACYAMQAKACAAIAAgACAAaQBmACAAKAAkAFIAZQBzAHUAbAB0AC4ARQB4AGMAZQBwAHQAaQBvAG4AKQAgAHsAdABoAHIAbwB3ACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAHQAbwBwAH0ACgAgACAAIAAgAGkAZgAgACgACgAgACAAIAAgACAAIAAgACAAJABSAGUAcwB1AGwAdAAgAC0AbABpAGsAZQAgACIAZgBhAHQAYQBsACoAIgAgAC0AbwByAAoAIAAgACAAIAAgACAAIAAgACQAUgBlAHMAdQBsAHQAIAAtAGwAaQBrAGUAIAAiAGUAcgByAG8AcgAqACIACgAgACAAIAAgACkAIAB7AHQAaAByAG8AdwAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwB0AG8AcAB9AAoACgB9ACAAYwBhAHQAYwBoACAAewAKACAAIAAgACAAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAkAFIAZQBzAHUAbAB0AFsAMABdACwAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACwAMAAsACcARQByAHIAbwByACcAKQAKACAAIAAgACAAcgBlAHQAdQByAG4ACgB9AAoACgAjACAAVQBwAGQAYQB0AGUAIABGAGkAbABlACAARQB4AHAAbABvAHIAZQByAAoAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAPQAgAFcAcgBpAHQAZQAtAFYAYwBzAFMAdABhAHQAdQBzAAoAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAPQAgACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAHwAIABGAG8AcgBFAGEAYwBoAC0ATwBiAGoAZQBjAHQAIAB7ACAAJABfACAALQByAGUAcABsAGEAYwBlACAAJwBcAHgAMQBiAFwAWwBbADAALQA5ADsAXQAqAG0AJwAsACcAJwAgAH0ACgAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAIAA9ACAAKABHAGUAdAAtAEcAaQB0AFMAdABhAHQAdQBzACkALgBSAGUAcABvAE4AYQBtAGUAIAArACAAJwAgACcAIAArACAAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAE4AYQBtAGUAcwBwAGEAYwBlACAAVQB0AGkAbAAgAC0ATgBhAG0AZQAgAFcAaQBuAEEAcABpACAAIAAtAE0AZQBtAGIAZQByAEQAZQBmAGkAbgBpAHQAaQBvAG4AIABAACIACgAgACAAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAdQBzAGUAcgAzADIALgBkAGwAbAAiACkAXQAKACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAEYAaQBuAGQAVwBpAG4AZABvAHcAKABzAHQAcgBpAG4AZwAgAGwAcABDAGwAYQBzAHMATgBhAG0AZQAsACAAcwB0AHIAaQBuAGcAIABsAHAAVwBpAG4AZABvAHcATgBhAG0AZQApADsACgAiAEAACgAKACQAaAB3AG4AZABUAG8AcABNAG8AcwB0AEYAaQBsAGUARQB4AHAAbABvAHIAZQByACAAPQAgAFsAVQB0AGkAbAAuAFcAaQBuAEEAcABpAF0AOgA6AEYAaQBuAGQAVwBpAG4AZABvAHcAKAAKACAAIAAiAEMAYQBiAGkAbgBlAHQAVwBDAGwAYQBzAHMAIgAsACAAIAAgACAAIAAjACAAdABoAGUAIAB3AGkAbgBkAG8AdwAgAGMAbABhAHMAcwAgAG8AZgAgAGkAbgB0AGUAcgBlAHMAdAAKACAAIABbAE4AdQBsAGwAUwB0AHIAaQBuAGcAXQA6ADoAVgBhAGwAdQBlACAAIAAjACAAbgBvACAAdwBpAG4AZABvAHcAIAB0AGkAdABsAGUAIAB0AG8AIABzAGUAYQByAGMAaAAgAGYAbwByAAoAKQAKAAoAQQBkAGQALQBUAHkAcABlACAALQBUAHkAcABlAEQAZQBmAGkAbgBpAHQAaQBvAG4AIABAACIACgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQA7AAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBSAHUAbgB0AGkAbQBlAC4ASQBuAHQAZQByAG8AcABTAGUAcgB2AGkAYwBlAHMAOwAKAAoAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGMAbABhAHMAcwAgAFcAaQBuADMAMgAgAHsACgAgACAAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAVQBzAGUAcgAzADIALgBkAGwAbAAiACwAIABFAG4AdAByAHkAUABvAGkAbgB0AD0AIgBTAGUAdABXAGkAbgBkAG8AdwBUAGUAeAB0ACIAKQBdAAoAIAAgAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAGkAbgB0ACAAUwBlAHQAVwBpAG4AZABvAHcAVABlAHgAdAAoAEkAbgB0AFAAdAByACAAaABXAG4AZAAsACAAcwB0AHIAaQBuAGcAIABzAHQAcgBUAGkAdABsAGUAKQA7AAoAfQAKACIAQAAKAAoAWwBXAGkAbgAzADIAXQA6ADoAUwBlAHQAVwBpAG4AZABvAHcAVABlAHgAdAAoACQAaAB3AG4AZABUAG8AcABNAG8AcwB0AEYAaQBsAGUARQB4AHAAbABvAHIAZQByACwAIAAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAKQAKAAoAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAkAFIAZQBzAHUAbAB0AFsAMABdACwAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACwAMAAsACcASQBuAGYAbwAnACkA"
