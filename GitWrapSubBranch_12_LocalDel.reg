Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\SOFTWARE\Classes\Directory\ContextMenus\GitWrap\GitWrapSub_Branch\shell\12_LocalDel\command]
; $cmd = @'
; # -------------
; # Delete Branch
; # -------------

; Add-Type -AssemblyName PresentationFramework

; try {
;     [string[]]$Result = git branch -l 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}

; } catch {
;     [System.Windows.MessageBox]::Show(
;         $Result[0],'Git for Windows',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; $Branches = $Result

; try {
;     $BranchToDelete = $Branches | Out-GridView -Title 'Git for Windows - Delete Branch [SELECT BRANCH]' -OutputMode Single
;     $BranchToDelete = $BranchToDelete.Substring(2)
;     if (!$BranchToDelete) {throw -ErrorAction stop}
;     if (
;         $BranchToDelete -eq 'master' -or
;         $BranchToDelete -eq 'main'
;     ) {throw -ErrorAction stop}

; } catch {
;     [System.Windows.MessageBox]::Show(
;         'Error in parameter input','Git for Windows',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; $ThisBranch = ((git branch -l) | where {$_ -like '`**'}).Substring(2)
; $RemoteBranches = git branch -r

; if (!$RemoteBranches) {# ask to merge with local branch
;     $MergeToMain = [System.Windows.MessageBox]::Show(
;         "Content of [$BranchToDelete] needs to `n be merged to Main before beeing removed.`n`nMerge to Main?",
;         'Git for Windows - Merge before deletion','YesNo','Exclamation','No','DefaultDesktopOnly'
;     )
;     if ($MergeToMain -eq 'No') {# abort deletion
;         return
;     }
;     git switch main
;     git merge $BranchToDelete
;     git swich $ThisBranch
; }

; try {
;     [string[]]$Result = git branch -d $BranchToDelete 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}
;     if (
;         $Result -like "fatal*" -or
;         $Result -like "error*"
;     ) {throw -ErrorAction Stop}

; } catch {
;     [System.Windows.MessageBox]::Show(
;         $Result[0],'Git for Windows',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; # Update File Explorer
; $ThisGitStatus = Write-VcsStatus
; $ThisGitStatus = $ThisGitStatus | ForEach-Object { $_ -replace '\x1b\[[0-9;]*m','' }
; $ThisGitStatus = (Get-GitStatus).RepoName + ' ' + $ThisGitStatus

; Add-Type -Namespace Util -Name WinApi  -MemberDefinition @"
;   [DllImport("user32.dll")]
;   public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
; "@

; $hwndTopMostFileExplorer = [Util.WinApi]::FindWindow(
;   "CabinetWClass",     # the window class of interest
;   [NullString]::Value  # no window title to search for
; )

; Add-Type -TypeDefinition @"
; using System;
; using System.Runtime.InteropServices;

; public static class Win32 {
;   [DllImport("User32.dll", EntryPoint="SetWindowText")]
;   public static extern int SetWindowText(IntPtr hWnd, string strTitle);
; }
; "@

; [Win32]::SetWindowText($hwndTopMostFileExplorer, $ThisGitStatus)

; [System.Windows.MessageBox]::Show(
;     $Result[0],'Git for Windows',0,'Info',0,'DefaultDesktopOnly'
; )
; '@
; [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($cmd))

@="pwsh.exe -WindowStyle hidden -EncodedCommand IwAgAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ACgAjACAARABlAGwAZQB0AGUAIABCAHIAYQBuAGMAaAAKACMAIAAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAEEAcwBzAGUAbQBiAGwAeQBOAGEAbQBlACAAUAByAGUAcwBlAG4AdABhAHQAaQBvAG4ARgByAGEAbQBlAHcAbwByAGsACgAKAHQAcgB5ACAAewAKACAAIAAgACAAWwBzAHQAcgBpAG4AZwBbAF0AXQAkAFIAZQBzAHUAbAB0ACAAPQAgAGcAaQB0ACAAYgByAGEAbgBjAGgAIAAtAGwAIAAyAD4AJgAxAAoAIAAgACAAIABpAGYAIAAoACQAUgBlAHMAdQBsAHQALgBFAHgAYwBlAHAAdABpAG8AbgApACAAewB0AGgAcgBvAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAFMAdABvAHAAfQAKAAoAfQAgAGMAYQB0AGMAaAAgAHsACgAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgACgAgACAAIAAgACAAIAAgACAAJABSAGUAcwB1AGwAdABbADAAXQAsACcARwBpAHQAIABmAG8AcgAgAFcAaQBuAGQAbwB3AHMAJwAsADAALAAnAEUAcgByAG8AcgAnACwAMAAsACcARABlAGYAYQB1AGwAdABEAGUAcwBrAHQAbwBwAE8AbgBsAHkAJwAKACAAIAAgACAAKQAKACAAIAAgACAAcgBlAHQAdQByAG4ACgB9AAoACgAkAEIAcgBhAG4AYwBoAGUAcwAgAD0AIAAkAFIAZQBzAHUAbAB0AAoACgB0AHIAeQAgAHsACgAgACAAIAAgACQAQgByAGEAbgBjAGgAVABvAEQAZQBsAGUAdABlACAAPQAgACQAQgByAGEAbgBjAGgAZQBzACAAfAAgAE8AdQB0AC0ARwByAGkAZABWAGkAZQB3ACAALQBUAGkAdABsAGUAIAAnAEcAaQB0ACAAZgBvAHIAIABXAGkAbgBkAG8AdwBzACAALQAgAEQAZQBsAGUAdABlACAAQgByAGEAbgBjAGgAIABbAFMARQBMAEUAQwBUACAAQgBSAEEATgBDAEgAXQAnACAALQBPAHUAdABwAHUAdABNAG8AZABlACAAUwBpAG4AZwBsAGUACgAgACAAIAAgACQAQgByAGEAbgBjAGgAVABvAEQAZQBsAGUAdABlACAAPQAgACQAQgByAGEAbgBjAGgAVABvAEQAZQBsAGUAdABlAC4AUwB1AGIAcwB0AHIAaQBuAGcAKAAyACkACgAgACAAIAAgAGkAZgAgACgAIQAkAEIAcgBhAG4AYwBoAFQAbwBEAGUAbABlAHQAZQApACAAewB0AGgAcgBvAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAHMAdABvAHAAfQAKACAAIAAgACAAaQBmACAAKAAKACAAIAAgACAAIAAgACAAIAAkAEIAcgBhAG4AYwBoAFQAbwBEAGUAbABlAHQAZQAgAC0AZQBxACAAJwBtAGEAcwB0AGUAcgAnACAALQBvAHIACgAgACAAIAAgACAAIAAgACAAJABCAHIAYQBuAGMAaABUAG8ARABlAGwAZQB0AGUAIAAtAGUAcQAgACcAbQBhAGkAbgAnAAoAIAAgACAAIAApACAAewB0AGgAcgBvAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAHMAdABvAHAAfQAKAAoAfQAgAGMAYQB0AGMAaAAgAHsACgAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgACgAgACAAIAAgACAAIAAgACAAJwBFAHIAcgBvAHIAIABpAG4AIABwAGEAcgBhAG0AZQB0AGUAcgAgAGkAbgBwAHUAdAAnACwAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACwAMAAsACcARQByAHIAbwByACcALAAwACwAJwBEAGUAZgBhAHUAbAB0AEQAZQBzAGsAdABvAHAATwBuAGwAeQAnAAoAIAAgACAAIAApAAoAIAAgACAAIAByAGUAdAB1AHIAbgAKAH0ACgAKACQAVABoAGkAcwBCAHIAYQBuAGMAaAAgAD0AIAAoACgAZwBpAHQAIABiAHIAYQBuAGMAaAAgAC0AbAApACAAfAAgAHcAaABlAHIAZQAgAHsAJABfACAALQBsAGkAawBlACAAJwBgACoAKgAnAH0AKQAuAFMAdQBiAHMAdAByAGkAbgBnACgAMgApAAoAJABSAGUAbQBvAHQAZQBCAHIAYQBuAGMAaABlAHMAIAA9ACAAZwBpAHQAIABiAHIAYQBuAGMAaAAgAC0AcgAKAAoAaQBmACAAKAAhACQAUgBlAG0AbwB0AGUAQgByAGEAbgBjAGgAZQBzACkAIAB7ACMAIABhAHMAawAgAHQAbwAgAG0AZQByAGcAZQAgAHcAaQB0AGgAIABsAG8AYwBhAGwAIABiAHIAYQBuAGMAaAAKACAAIAAgACAAJABNAGUAcgBnAGUAVABvAE0AYQBpAG4AIAA9ACAAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAKACAAIAAgACAAIAAgACAAIAAiAEMAbwBuAHQAZQBuAHQAIABvAGYAIABbACQAQgByAGEAbgBjAGgAVABvAEQAZQBsAGUAdABlAF0AIABuAGUAZQBkAHMAIAB0AG8AIABgAG4AIABiAGUAIABtAGUAcgBnAGUAZAAgAHQAbwAgAE0AYQBpAG4AIABiAGUAZgBvAHIAZQAgAGIAZQBlAGkAbgBnACAAcgBlAG0AbwB2AGUAZAAuAGAAbgBgAG4ATQBlAHIAZwBlACAAdABvACAATQBhAGkAbgA/ACIALAAKACAAIAAgACAAIAAgACAAIAAnAEcAaQB0ACAAZgBvAHIAIABXAGkAbgBkAG8AdwBzACAALQAgAE0AZQByAGcAZQAgAGIAZQBmAG8AcgBlACAAZABlAGwAZQB0AGkAbwBuACcALAAnAFkAZQBzAE4AbwAnACwAJwBFAHgAYwBsAGEAbQBhAHQAaQBvAG4AJwAsACcATgBvACcALAAnAEQAZQBmAGEAdQBsAHQARABlAHMAawB0AG8AcABPAG4AbAB5ACcACgAgACAAIAAgACkACgAgACAAIAAgAGkAZgAgACgAJABNAGUAcgBnAGUAVABvAE0AYQBpAG4AIAAtAGUAcQAgACcATgBvACcAKQAgAHsAIwAgAGEAYgBvAHIAdAAgAGQAZQBsAGUAdABpAG8AbgAKACAAIAAgACAAIAAgACAAIAByAGUAdAB1AHIAbgAKACAAIAAgACAAfQAKACAAIAAgACAAZwBpAHQAIABzAHcAaQB0AGMAaAAgAG0AYQBpAG4ACgAgACAAIAAgAGcAaQB0ACAAbQBlAHIAZwBlACAAJABCAHIAYQBuAGMAaABUAG8ARABlAGwAZQB0AGUACgAgACAAIAAgAGcAaQB0ACAAcwB3AGkAYwBoACAAJABUAGgAaQBzAEIAcgBhAG4AYwBoAAoAfQAKAAoAdAByAHkAIAB7AAoAIAAgACAAIABbAHMAdAByAGkAbgBnAFsAXQBdACQAUgBlAHMAdQBsAHQAIAA9ACAAZwBpAHQAIABiAHIAYQBuAGMAaAAgAC0AZAAgACQAQgByAGEAbgBjAGgAVABvAEQAZQBsAGUAdABlACAAMgA+ACYAMQAKACAAIAAgACAAaQBmACAAKAAkAFIAZQBzAHUAbAB0AC4ARQB4AGMAZQBwAHQAaQBvAG4AKQAgAHsAdABoAHIAbwB3ACAALQBFAHIAcgBvAHIAQQBjAHQAaQBvAG4AIABTAHQAbwBwAH0ACgAgACAAIAAgAGkAZgAgACgACgAgACAAIAAgACAAIAAgACAAJABSAGUAcwB1AGwAdAAgAC0AbABpAGsAZQAgACIAZgBhAHQAYQBsACoAIgAgAC0AbwByAAoAIAAgACAAIAAgACAAIAAgACQAUgBlAHMAdQBsAHQAIAAtAGwAaQBrAGUAIAAiAGUAcgByAG8AcgAqACIACgAgACAAIAAgACkAIAB7AHQAaAByAG8AdwAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwB0AG8AcAB9AAoACgB9ACAAYwBhAHQAYwBoACAAewAKACAAIAAgACAAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAKACAAIAAgACAAIAAgACAAIAAkAFIAZQBzAHUAbAB0AFsAMABdACwAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACwAMAAsACcARQByAHIAbwByACcALAAwACwAJwBEAGUAZgBhAHUAbAB0AEQAZQBzAGsAdABvAHAATwBuAGwAeQAnAAoAIAAgACAAIAApAAoAIAAgACAAIAByAGUAdAB1AHIAbgAKAH0ACgAKACMAIABVAHAAZABhAHQAZQAgAEYAaQBsAGUAIABFAHgAcABsAG8AcgBlAHIACgAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAIAA9ACAAVwByAGkAdABlAC0AVgBjAHMAUwB0AGEAdAB1AHMACgAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAIAA9ACAAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAfAAgAEYAbwByAEUAYQBjAGgALQBPAGIAagBlAGMAdAAgAHsAIAAkAF8AIAAtAHIAZQBwAGwAYQBjAGUAIAAnAFwAeAAxAGIAXABbAFsAMAAtADkAOwBdACoAbQAnACwAJwAnACAAfQAKACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAD0AIAAoAEcAZQB0AC0ARwBpAHQAUwB0AGEAdAB1AHMAKQAuAFIAZQBwAG8ATgBhAG0AZQAgACsAIAAnACAAJwAgACsAIAAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMACgAKAEEAZABkAC0AVAB5AHAAZQAgAC0ATgBhAG0AZQBzAHAAYQBjAGUAIABVAHQAaQBsACAALQBOAGEAbQBlACAAVwBpAG4AQQBwAGkAIAAgAC0ATQBlAG0AYgBlAHIARABlAGYAaQBuAGkAdABpAG8AbgAgAEAAIgAKACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgB1AHMAZQByADMAMgAuAGQAbABsACIAKQBdAAoAIAAgAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAARgBpAG4AZABXAGkAbgBkAG8AdwAoAHMAdAByAGkAbgBnACAAbABwAEMAbABhAHMAcwBOAGEAbQBlACwAIABzAHQAcgBpAG4AZwAgAGwAcABXAGkAbgBkAG8AdwBOAGEAbQBlACkAOwAKACIAQAAKAAoAJABoAHcAbgBkAFQAbwBwAE0AbwBzAHQARgBpAGwAZQBFAHgAcABsAG8AcgBlAHIAIAA9ACAAWwBVAHQAaQBsAC4AVwBpAG4AQQBwAGkAXQA6ADoARgBpAG4AZABXAGkAbgBkAG8AdwAoAAoAIAAgACIAQwBhAGIAaQBuAGUAdABXAEMAbABhAHMAcwAiACwAIAAgACAAIAAgACMAIAB0AGgAZQAgAHcAaQBuAGQAbwB3ACAAYwBsAGEAcwBzACAAbwBmACAAaQBuAHQAZQByAGUAcwB0AAoAIAAgAFsATgB1AGwAbABTAHQAcgBpAG4AZwBdADoAOgBWAGEAbAB1AGUAIAAgACMAIABuAG8AIAB3AGkAbgBkAG8AdwAgAHQAaQB0AGwAZQAgAHQAbwAgAHMAZQBhAHIAYwBoACAAZgBvAHIACgApAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAFQAeQBwAGUARABlAGYAaQBuAGkAdABpAG8AbgAgAEAAIgAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtADsACgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQAuAFIAdQBuAHQAaQBtAGUALgBJAG4AdABlAHIAbwBwAFMAZQByAHYAaQBjAGUAcwA7AAoACgBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAYwBsAGEAcwBzACAAVwBpAG4AMwAyACAAewAKACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBVAHMAZQByADMAMgAuAGQAbABsACIALAAgAEUAbgB0AHIAeQBQAG8AaQBuAHQAPQAiAFMAZQB0AFcAaQBuAGQAbwB3AFQAZQB4AHQAIgApAF0ACgAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAAaQBuAHQAIABTAGUAdABXAGkAbgBkAG8AdwBUAGUAeAB0ACgASQBuAHQAUAB0AHIAIABoAFcAbgBkACwAIABzAHQAcgBpAG4AZwAgAHMAdAByAFQAaQB0AGwAZQApADsACgB9AAoAIgBAAAoACgBbAFcAaQBuADMAMgBdADoAOgBTAGUAdABXAGkAbgBkAG8AdwBUAGUAeAB0ACgAJABoAHcAbgBkAFQAbwBwAE0AbwBzAHQARgBpAGwAZQBFAHgAcABsAG8AcgBlAHIALAAgACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwApAAoACgBbAFMAeQBzAHQAZQBtAC4AVwBpAG4AZABvAHcAcwAuAE0AZQBzAHMAYQBnAGUAQgBvAHgAXQA6ADoAUwBoAG8AdwAoAAoAIAAgACAAIAAkAFIAZQBzAHUAbAB0AFsAMABdACwAJwBHAGkAdAAgAGYAbwByACAAVwBpAG4AZABvAHcAcwAnACwAMAAsACcASQBuAGYAbwAnACwAMAAsACcARABlAGYAYQB1AGwAdABEAGUAcwBrAHQAbwBwAE8AbgBsAHkAJwAKACkA"
