Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\SOFTWARE\Classes\Directory\ContextMenus\GitWrap\GitWrapSub_Branch\shell\11_Switch\command]
; $cmd = @'
; # -------------
; # Switch Branch
; # -------------

; Add-Type -AssemblyName PresentationFramework

; # https://unicode.org/emoji/charts/full-emoji-list.html
; $CheckMark  = "`u{2714}"
; $CrossMark  = "`u{274C}"
; $Warning    = "`u{26A0}"
; $Prohibited = "`{1F6AB}"
; $BlackCircle = "`u{26AB}"
; $WhiteCircle = "`u{26AA}"
; $Triangle   = "`u{1F53A}"
; $ShuffleTrack = "`u{1F500}"

; try {
;     $DirtyStatus = git status --porcelain 2>&1
;     if ($DirtyStatus.Exception.Message -like 'fatal:*') {throw}
; } catch {
;     [System.Windows.MessageBox]::Show(# error
;         $DirtyStatus.Exception.Message,'GitWrap',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; if ($DirtyStatus) {
;     $Choice = [System.Windows.MessageBox]::Show(#status
;         "Repository isn't in a clean status. `n" +
;         "It contains untracked or changed files.`n`n" +
;         "$DirtyStatus `n`n" +
;         "WARNING: Clicking 'OK' to continue switching branch `n" + 
;         "might move the file(s) along.",
;         'GitWrap','OkCancel','Warning','Cancel','DefaultDesktopOnly'
;     )
;     if ($Choice -ne 'Ok') {return}
; }

; try {
;     $Result = git branch -a 2>&1
;     if ($Result[-1].Exception.Message -Like 'fatal:*') {throw}

; } catch {
;     [System.Windows.MessageBox]::Show(# error
;         $Result[-1].Exception.Message,'GitWrap',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; [string[]]$Branches = $Result | where {$_ -notlike '*HEAD*'}

; try {
;     $Branch = $Branches | Out-GridView -Title 'GitWrap - Switch Branch [SELECT BRANCH]' -OutputMode Single
;     if (!$Branch) {throw}

; } catch {
;     [System.Windows.MessageBox]::Show(# error
;         'Error in parameter input','GitWrap',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; $Branch = [regex]::Replace($Branch,'^..remotes/.*?/|^..','') # remove 'remotes/origin/' or two first chars

; try {
;     $Result = git switch $Branch 2>&1
;     if ($Result.Exception.Message -like 'fatal:*') {throw}

; } catch {
;     [System.Windows.MessageBox]::Show(# error
;         $Result.Exception.Message,'GitWrap',0,'Error',0,'DefaultDesktopOnly'
;     )
;     return
; }

; [System.Windows.MessageBox]::Show(# result
;     $Result[0],'GitWrap',0,'Info',0,'DefaultDesktopOnly'
; )

; # Update File Explorer
; $ThisGitStatus = Write-VcsStatus
; $ThisGitStatus = $ThisGitStatus | ForEach-Object { $_ -replace '\x1b\[[0-9;]*m','' }
; $ThisGitStatus = $ShuffleTrack + ' ' + (Get-GitStatus).RepoName + ' ' + $ThisGitStatus

; Add-Type -Namespace Util -Name WinApi  -MemberDefinition @"
;   [DllImport("user32.dll")]
;   public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
; "@

; $hwndTopMostFileExplorer = [Util.WinApi]::FindWindow(
;   "CabinetWClass",     # the window class of interest
;   [NullString]::Value  # no window title to search for
; )

; Add-Type -TypeDefinition @"
; using System;
; using System.Runtime.InteropServices;

; public static class Win32 {
;   [DllImport("User32.dll", CharSet=CharSet.Unicode, EntryPoint="SetWindowText")]
;   public static extern int SetWindowText(IntPtr hWnd, string strTitle);
; }
; "@

; [Win32]::SetWindowText($hwndTopMostFileExplorer, $ThisGitStatus)

; '@
; [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($cmd))

@="pwsh.exe -WindowStyle hidden -EncodedCommand IwAgAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ACgAjACAAUwB3AGkAdABjAGgAIABCAHIAYQBuAGMAaAAKACMAIAAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAEEAcwBzAGUAbQBiAGwAeQBOAGEAbQBlACAAUAByAGUAcwBlAG4AdABhAHQAaQBvAG4ARgByAGEAbQBlAHcAbwByAGsACgAKACMAIABoAHQAdABwAHMAOgAvAC8AdQBuAGkAYwBvAGQAZQAuAG8AcgBnAC8AZQBtAG8AagBpAC8AYwBoAGEAcgB0AHMALwBmAHUAbABsAC0AZQBtAG8AagBpAC0AbABpAHMAdAAuAGgAdABtAGwACgAkAEMAaABlAGMAawBNAGEAcgBrACAAIAA9ACAAIgBgAHUAewAyADcAMQA0AH0AIgAKACQAQwByAG8AcwBzAE0AYQByAGsAIAAgAD0AIAAiAGAAdQB7ADIANwA0AEMAfQAiAAoAJABXAGEAcgBuAGkAbgBnACAAIAAgACAAPQAgACIAYAB1AHsAMgA2AEEAMAB9ACIACgAkAFAAcgBvAGgAaQBiAGkAdABlAGQAIAA9ACAAIgBgAHsAMQBGADYAQQBCAH0AIgAKACQAQgBsAGEAYwBrAEMAaQByAGMAbABlACAAPQAgACIAYAB1AHsAMgA2AEEAQgB9ACIACgAkAFcAaABpAHQAZQBDAGkAcgBjAGwAZQAgAD0AIAAiAGAAdQB7ADIANgBBAEEAfQAiAAoAJABUAHIAaQBhAG4AZwBsAGUAIAAgACAAPQAgACIAYAB1AHsAMQBGADUAMwBBAH0AIgAKACQAUwBoAHUAZgBmAGwAZQBUAHIAYQBjAGsAIAA9ACAAIgBgAHUAewAxAEYANQAwADAAfQAiAAoACgB0AHIAeQAgAHsACgAgACAAIAAgACQARABpAHIAdAB5AFMAdABhAHQAdQBzACAAPQAgAGcAaQB0ACAAcwB0AGEAdAB1AHMAIAAtAC0AcABvAHIAYwBlAGwAYQBpAG4AIAAyAD4AJgAxAAoAIAAgACAAIABpAGYAIAAoACQARABpAHIAdAB5AFMAdABhAHQAdQBzAC4ARQB4AGMAZQBwAHQAaQBvAG4ALgBNAGUAcwBzAGEAZwBlACAALQBsAGkAawBlACAAJwBmAGEAdABhAGwAOgAqACcAKQAgAHsAdABoAHIAbwB3AH0ACgB9ACAAYwBhAHQAYwBoACAAewAKACAAIAAgACAAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAjACAAZQByAHIAbwByAAoAIAAgACAAIAAgACAAIAAgACQARABpAHIAdAB5AFMAdABhAHQAdQBzAC4ARQB4AGMAZQBwAHQAaQBvAG4ALgBNAGUAcwBzAGEAZwBlACwAJwBHAGkAdABXAHIAYQBwACcALAAwACwAJwBFAHIAcgBvAHIAJwAsADAALAAnAEQAZQBmAGEAdQBsAHQARABlAHMAawB0AG8AcABPAG4AbAB5ACcACgAgACAAIAAgACkACgAgACAAIAAgAHIAZQB0AHUAcgBuAAoAfQAKAAoAaQBmACAAKAAkAEQAaQByAHQAeQBTAHQAYQB0AHUAcwApACAAewAKACAAIAAgACAAJABDAGgAbwBpAGMAZQAgAD0AIABbAFMAeQBzAHQAZQBtAC4AVwBpAG4AZABvAHcAcwAuAE0AZQBzAHMAYQBnAGUAQgBvAHgAXQA6ADoAUwBoAG8AdwAoACMAcwB0AGEAdAB1AHMACgAgACAAIAAgACAAIAAgACAAIgBSAGUAcABvAHMAaQB0AG8AcgB5ACAAaQBzAG4AJwB0ACAAaQBuACAAYQAgAGMAbABlAGEAbgAgAHMAdABhAHQAdQBzAC4AIABgAG4AIgAgACsACgAgACAAIAAgACAAIAAgACAAIgBJAHQAIABjAG8AbgB0AGEAaQBuAHMAIAB1AG4AdAByAGEAYwBrAGUAZAAgAG8AcgAgAGMAaABhAG4AZwBlAGQAIABmAGkAbABlAHMALgBgAG4AYABuACIAIAArAAoAIAAgACAAIAAgACAAIAAgACIAJABEAGkAcgB0AHkAUwB0AGEAdAB1AHMAIABgAG4AYABuACIAIAArAAoAIAAgACAAIAAgACAAIAAgACIAVwBBAFIATgBJAE4ARwA6ACAAQwBsAGkAYwBrAGkAbgBnACAAJwBPAEsAJwAgAHQAbwAgAGMAbwBuAHQAaQBuAHUAZQAgAHMAdwBpAHQAYwBoAGkAbgBnACAAYgByAGEAbgBjAGgAIABgAG4AIgAgACsAIAAKACAAIAAgACAAIAAgACAAIAAiAG0AaQBnAGgAdAAgAG0AbwB2AGUAIAB0AGgAZQAgAGYAaQBsAGUAKABzACkAIABhAGwAbwBuAGcALgAiACwACgAgACAAIAAgACAAIAAgACAAJwBHAGkAdABXAHIAYQBwACcALAAnAE8AawBDAGEAbgBjAGUAbAAnACwAJwBXAGEAcgBuAGkAbgBnACcALAAnAEMAYQBuAGMAZQBsACcALAAnAEQAZQBmAGEAdQBsAHQARABlAHMAawB0AG8AcABPAG4AbAB5ACcACgAgACAAIAAgACkACgAgACAAIAAgAGkAZgAgACgAJABDAGgAbwBpAGMAZQAgAC0AbgBlACAAJwBPAGsAJwApACAAewByAGUAdAB1AHIAbgB9AAoAfQAKAAoAdAByAHkAIAB7AAoAIAAgACAAIAAkAFIAZQBzAHUAbAB0ACAAPQAgAGcAaQB0ACAAYgByAGEAbgBjAGgAIAAtAGEAIAAyAD4AJgAxAAoAIAAgACAAIABpAGYAIAAoACQAUgBlAHMAdQBsAHQAWwAtADEAXQAuAEUAeABjAGUAcAB0AGkAbwBuAC4ATQBlAHMAcwBhAGcAZQAgAC0ATABpAGsAZQAgACcAZgBhAHQAYQBsADoAKgAnACkAIAB7AHQAaAByAG8AdwB9AAoACgB9ACAAYwBhAHQAYwBoACAAewAKACAAIAAgACAAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAjACAAZQByAHIAbwByAAoAIAAgACAAIAAgACAAIAAgACQAUgBlAHMAdQBsAHQAWwAtADEAXQAuAEUAeABjAGUAcAB0AGkAbwBuAC4ATQBlAHMAcwBhAGcAZQAsACcARwBpAHQAVwByAGEAcAAnACwAMAAsACcARQByAHIAbwByACcALAAwACwAJwBEAGUAZgBhAHUAbAB0AEQAZQBzAGsAdABvAHAATwBuAGwAeQAnAAoAIAAgACAAIAApAAoAIAAgACAAIAByAGUAdAB1AHIAbgAKAH0ACgAKAFsAcwB0AHIAaQBuAGcAWwBdAF0AJABCAHIAYQBuAGMAaABlAHMAIAA9ACAAJABSAGUAcwB1AGwAdAAgAHwAIAB3AGgAZQByAGUAIAB7ACQAXwAgAC0AbgBvAHQAbABpAGsAZQAgACcAKgBIAEUAQQBEACoAJwB9AAoACgB0AHIAeQAgAHsACgAgACAAIAAgACQAQgByAGEAbgBjAGgAIAA9ACAAJABCAHIAYQBuAGMAaABlAHMAIAB8ACAATwB1AHQALQBHAHIAaQBkAFYAaQBlAHcAIAAtAFQAaQB0AGwAZQAgACcARwBpAHQAVwByAGEAcAAgAC0AIABTAHcAaQB0AGMAaAAgAEIAcgBhAG4AYwBoACAAWwBTAEUATABFAEMAVAAgAEIAUgBBAE4AQwBIAF0AJwAgAC0ATwB1AHQAcAB1AHQATQBvAGQAZQAgAFMAaQBuAGcAbABlAAoAIAAgACAAIABpAGYAIAAoACEAJABCAHIAYQBuAGMAaAApACAAewB0AGgAcgBvAHcAfQAKAAoAfQAgAGMAYQB0AGMAaAAgAHsACgAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgAIwAgAGUAcgByAG8AcgAKACAAIAAgACAAIAAgACAAIAAnAEUAcgByAG8AcgAgAGkAbgAgAHAAYQByAGEAbQBlAHQAZQByACAAaQBuAHAAdQB0ACcALAAnAEcAaQB0AFcAcgBhAHAAJwAsADAALAAnAEUAcgByAG8AcgAnACwAMAAsACcARABlAGYAYQB1AGwAdABEAGUAcwBrAHQAbwBwAE8AbgBsAHkAJwAKACAAIAAgACAAKQAKACAAIAAgACAAcgBlAHQAdQByAG4ACgB9AAoACgAkAEIAcgBhAG4AYwBoACAAPQAgAFsAcgBlAGcAZQB4AF0AOgA6AFIAZQBwAGwAYQBjAGUAKAAkAEIAcgBhAG4AYwBoACwAJwBeAC4ALgByAGUAbQBvAHQAZQBzAC8ALgAqAD8ALwB8AF4ALgAuACcALAAnACcAKQAgACMAIAByAGUAbQBvAHYAZQAgACcAcgBlAG0AbwB0AGUAcwAvAG8AcgBpAGcAaQBuAC8AJwAgAG8AcgAgAHQAdwBvACAAZgBpAHIAcwB0ACAAYwBoAGEAcgBzAAoACgB0AHIAeQAgAHsACgAgACAAIAAgACQAUgBlAHMAdQBsAHQAIAA9ACAAZwBpAHQAIABzAHcAaQB0AGMAaAAgACQAQgByAGEAbgBjAGgAIAAyAD4AJgAxAAoAIAAgACAAIABpAGYAIAAoACQAUgBlAHMAdQBsAHQALgBFAHgAYwBlAHAAdABpAG8AbgAuAE0AZQBzAHMAYQBnAGUAIAAtAGwAaQBrAGUAIAAnAGYAYQB0AGEAbAA6ACoAJwApACAAewB0AGgAcgBvAHcAfQAKAAoAfQAgAGMAYQB0AGMAaAAgAHsACgAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgAIwAgAGUAcgByAG8AcgAKACAAIAAgACAAIAAgACAAIAAkAFIAZQBzAHUAbAB0AC4ARQB4AGMAZQBwAHQAaQBvAG4ALgBNAGUAcwBzAGEAZwBlACwAJwBHAGkAdABXAHIAYQBwACcALAAwACwAJwBFAHIAcgBvAHIAJwAsADAALAAnAEQAZQBmAGEAdQBsAHQARABlAHMAawB0AG8AcABPAG4AbAB5ACcACgAgACAAIAAgACkACgAgACAAIAAgAHIAZQB0AHUAcgBuAAoAfQAKAAoAWwBTAHkAcwB0AGUAbQAuAFcAaQBuAGQAbwB3AHMALgBNAGUAcwBzAGEAZwBlAEIAbwB4AF0AOgA6AFMAaABvAHcAKAAjACAAcgBlAHMAdQBsAHQACgAgACAAIAAgACQAUgBlAHMAdQBsAHQAWwAwAF0ALAAnAEcAaQB0AFcAcgBhAHAAJwAsADAALAAnAEkAbgBmAG8AJwAsADAALAAnAEQAZQBmAGEAdQBsAHQARABlAHMAawB0AG8AcABPAG4AbAB5ACcACgApAAoACgAjACAAVQBwAGQAYQB0AGUAIABGAGkAbABlACAARQB4AHAAbABvAHIAZQByAAoAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAPQAgAFcAcgBpAHQAZQAtAFYAYwBzAFMAdABhAHQAdQBzAAoAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAPQAgACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAHwAIABGAG8AcgBFAGEAYwBoAC0ATwBiAGoAZQBjAHQAIAB7ACAAJABfACAALQByAGUAcABsAGEAYwBlACAAJwBcAHgAMQBiAFwAWwBbADAALQA5ADsAXQAqAG0AJwAsACcAJwAgAH0ACgAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAIAA9ACAAJABTAGgAdQBmAGYAbABlAFQAcgBhAGMAawAgACsAIAAnACAAJwAgACsAIAAoAEcAZQB0AC0ARwBpAHQAUwB0AGEAdAB1AHMAKQAuAFIAZQBwAG8ATgBhAG0AZQAgACsAIAAnACAAJwAgACsAIAAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMACgAKAEEAZABkAC0AVAB5AHAAZQAgAC0ATgBhAG0AZQBzAHAAYQBjAGUAIABVAHQAaQBsACAALQBOAGEAbQBlACAAVwBpAG4AQQBwAGkAIAAgAC0ATQBlAG0AYgBlAHIARABlAGYAaQBuAGkAdABpAG8AbgAgAEAAIgAKACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgB1AHMAZQByADMAMgAuAGQAbABsACIAKQBdAAoAIAAgAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAARgBpAG4AZABXAGkAbgBkAG8AdwAoAHMAdAByAGkAbgBnACAAbABwAEMAbABhAHMAcwBOAGEAbQBlACwAIABzAHQAcgBpAG4AZwAgAGwAcABXAGkAbgBkAG8AdwBOAGEAbQBlACkAOwAKACIAQAAKAAoAJABoAHcAbgBkAFQAbwBwAE0AbwBzAHQARgBpAGwAZQBFAHgAcABsAG8AcgBlAHIAIAA9ACAAWwBVAHQAaQBsAC4AVwBpAG4AQQBwAGkAXQA6ADoARgBpAG4AZABXAGkAbgBkAG8AdwAoAAoAIAAgACIAQwBhAGIAaQBuAGUAdABXAEMAbABhAHMAcwAiACwAIAAgACAAIAAgACMAIAB0AGgAZQAgAHcAaQBuAGQAbwB3ACAAYwBsAGEAcwBzACAAbwBmACAAaQBuAHQAZQByAGUAcwB0AAoAIAAgAFsATgB1AGwAbABTAHQAcgBpAG4AZwBdADoAOgBWAGEAbAB1AGUAIAAgACMAIABuAG8AIAB3AGkAbgBkAG8AdwAgAHQAaQB0AGwAZQAgAHQAbwAgAHMAZQBhAHIAYwBoACAAZgBvAHIACgApAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAFQAeQBwAGUARABlAGYAaQBuAGkAdABpAG8AbgAgAEAAIgAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtADsACgB1AHMAaQBuAGcAIABTAHkAcwB0AGUAbQAuAFIAdQBuAHQAaQBtAGUALgBJAG4AdABlAHIAbwBwAFMAZQByAHYAaQBjAGUAcwA7AAoACgBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAYwBsAGEAcwBzACAAVwBpAG4AMwAyACAAewAKACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBVAHMAZQByADMAMgAuAGQAbABsACIALAAgAEMAaABhAHIAUwBlAHQAPQBDAGgAYQByAFMAZQB0AC4AVQBuAGkAYwBvAGQAZQAsACAARQBuAHQAcgB5AFAAbwBpAG4AdAA9ACIAUwBlAHQAVwBpAG4AZABvAHcAVABlAHgAdAAiACkAXQAKACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABpAG4AdAAgAFMAZQB0AFcAaQBuAGQAbwB3AFQAZQB4AHQAKABJAG4AdABQAHQAcgAgAGgAVwBuAGQALAAgAHMAdAByAGkAbgBnACAAcwB0AHIAVABpAHQAbABlACkAOwAKAH0ACgAiAEAACgAKAFsAVwBpAG4AMwAyAF0AOgA6AFMAZQB0AFcAaQBuAGQAbwB3AFQAZQB4AHQAKAAkAGgAdwBuAGQAVABvAHAATQBvAHMAdABGAGkAbABlAEUAeABwAGwAbwByAGUAcgAsACAAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACkACgA="
