Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\SOFTWARE\Classes\Directory\ContextMenus\GitWrap\GitWrapSub_Commit\shell\11_Fix\command]
; $cmd = @'
; # ----------
; # Commit fix
; # ----------

; Add-Type -AssemblyName PresentationFramework
 
; try {
;     [string[]]$Result = git status 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}

;     [string[]]$Result = git add . 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}

;     [string[]]$Result = git commit -m'fix(ref):' 2>&1
;     if ($Result.Exception) {throw -ErrorAction Stop}
;     if (($Result | Select -Index 1) -like 'nothing to commit*') {
;         $Result[0] = $Result[1]
;         throw -ErrorAction Stop
;     }

;     [string[]]$Result = git commit --amend 2>&1
;     if (
;         $Result.Exception -and
;         $Result[0].Exception -notlike "*unix2dos*"
;     ) {throw -ErrorAction Stop}

; } catch {
;     [System.Windows.MessageBox]::Show($Result[0],'Git for Windows',0,'Error')
;     return
; }

; # Update File Explorer
; $ThisGitStatus = Write-VcsStatus
; $ThisGitStatus = $ThisGitStatus | ForEach-Object { $_ -replace '\x1b\[[0-9;]*m','' }
; $ThisGitStatus = (Get-GitStatus).RepoName + ' ' + $ThisGitStatus

; Add-Type -Namespace Util -Name WinApi  -MemberDefinition @"
;   [DllImport("user32.dll")]
;   public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
; "@

; $hwndTopMostFileExplorer = [Util.WinApi]::FindWindow(
;   "CabinetWClass",     # the window class of interest
;   [NullString]::Value  # no window title to search for
; )

; Add-Type -TypeDefinition @"
; using System;
; using System.Runtime.InteropServices;

; public static class Win32 {
;   [DllImport("User32.dll", EntryPoint="SetWindowText")]
;   public static extern int SetWindowText(IntPtr hWnd, string strTitle);
; }
; "@

; [Win32]::SetWindowText($hwndTopMostFileExplorer, $ThisGitStatus)

; [System.Windows.MessageBox]::Show($Result[0],'Git for Windows',0,'Info')
; '@
; [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($cmd))

@="pwsh.exe -WindowStyle hidden -EncodedCommand IwAgAC0ALQAtAC0ALQAtAC0ALQAtAC0ACgAjACAAQwBvAG0AbQBpAHQAIABmAGkAeAAKACMAIAAtAC0ALQAtAC0ALQAtAC0ALQAtAAoACgBBAGQAZAAtAFQAeQBwAGUAIAAtAEEAcwBzAGUAbQBiAGwAeQBOAGEAbQBlACAAUAByAGUAcwBlAG4AdABhAHQAaQBvAG4ARgByAGEAbQBlAHcAbwByAGsACgAgAAoAdAByAHkAIAB7AAoAIAAgACAAIABbAHMAdAByAGkAbgBnAFsAXQBdACQAUgBlAHMAdQBsAHQAIAA9ACAAZwBpAHQAIABzAHQAYQB0AHUAcwAgADIAPgAmADEACgAgACAAIAAgAGkAZgAgACgAJABSAGUAcwB1AGwAdAAuAEUAeABjAGUAcAB0AGkAbwBuACkAIAB7AHQAaAByAG8AdwAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwB0AG8AcAB9AAoACgAgACAAIAAgAFsAcwB0AHIAaQBuAGcAWwBdAF0AJABSAGUAcwB1AGwAdAAgAD0AIABnAGkAdAAgAGEAZABkACAALgAgADIAPgAmADEACgAgACAAIAAgAGkAZgAgACgAJABSAGUAcwB1AGwAdAAuAEUAeABjAGUAcAB0AGkAbwBuACkAIAB7AHQAaAByAG8AdwAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwB0AG8AcAB9AAoACgAgACAAIAAgAFsAcwB0AHIAaQBuAGcAWwBdAF0AJABSAGUAcwB1AGwAdAAgAD0AIABnAGkAdAAgAGMAbwBtAG0AaQB0ACAALQBtACcAZgBpAHgAKAByAGUAZgApADoAJwAgADIAPgAmADEACgAgACAAIAAgAGkAZgAgACgAJABSAGUAcwB1AGwAdAAuAEUAeABjAGUAcAB0AGkAbwBuACkAIAB7AHQAaAByAG8AdwAgAC0ARQByAHIAbwByAEEAYwB0AGkAbwBuACAAUwB0AG8AcAB9AAoAIAAgACAAIABpAGYAIAAoACgAJABSAGUAcwB1AGwAdAAgAHwAIABTAGUAbABlAGMAdAAgAC0ASQBuAGQAZQB4ACAAMQApACAALQBsAGkAawBlACAAJwBuAG8AdABoAGkAbgBnACAAdABvACAAYwBvAG0AbQBpAHQAKgAnACkAIAB7AAoAIAAgACAAIAAgACAAIAAgACQAUgBlAHMAdQBsAHQAWwAwAF0AIAA9ACAAJABSAGUAcwB1AGwAdABbADEAXQAKACAAIAAgACAAIAAgACAAIAB0AGgAcgBvAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAFMAdABvAHAACgAgACAAIAAgAH0ACgAKACAAIAAgACAAWwBzAHQAcgBpAG4AZwBbAF0AXQAkAFIAZQBzAHUAbAB0ACAAPQAgAGcAaQB0ACAAYwBvAG0AbQBpAHQAIAAtAC0AYQBtAGUAbgBkACAAMgA+ACYAMQAKACAAIAAgACAAaQBmACAAKAAKACAAIAAgACAAIAAgACAAIAAkAFIAZQBzAHUAbAB0AC4ARQB4AGMAZQBwAHQAaQBvAG4AIAAtAGEAbgBkAAoAIAAgACAAIAAgACAAIAAgACQAUgBlAHMAdQBsAHQAWwAwAF0ALgBFAHgAYwBlAHAAdABpAG8AbgAgAC0AbgBvAHQAbABpAGsAZQAgACIAKgB1AG4AaQB4ADIAZABvAHMAKgAiAAoAIAAgACAAIAApACAAewB0AGgAcgBvAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAFMAdABvAHAAfQAKAAoAfQAgAGMAYQB0AGMAaAAgAHsACgAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgAJABSAGUAcwB1AGwAdABbADAAXQAsACcARwBpAHQAIABmAG8AcgAgAFcAaQBuAGQAbwB3AHMAJwAsADAALAAnAEUAcgByAG8AcgAnACkACgAgACAAIAAgAHIAZQB0AHUAcgBuAAoAfQAKAAoAIwAgAFUAcABkAGEAdABlACAARgBpAGwAZQAgAEUAeABwAGwAbwByAGUAcgAKACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAD0AIABXAHIAaQB0AGUALQBWAGMAcwBTAHQAYQB0AHUAcwAKACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAgAD0AIAAkAFQAaABpAHMARwBpAHQAUwB0AGEAdAB1AHMAIAB8ACAARgBvAHIARQBhAGMAaAAtAE8AYgBqAGUAYwB0ACAAewAgACQAXwAgAC0AcgBlAHAAbABhAGMAZQAgACcAXAB4ADEAYgBcAFsAWwAwAC0AOQA7AF0AKgBtACcALAAnACcAIAB9AAoAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACAAPQAgACgARwBlAHQALQBHAGkAdABTAHQAYQB0AHUAcwApAC4AUgBlAHAAbwBOAGEAbQBlACAAKwAgACcAIAAnACAAKwAgACQAVABoAGkAcwBHAGkAdABTAHQAYQB0AHUAcwAKAAoAQQBkAGQALQBUAHkAcABlACAALQBOAGEAbQBlAHMAcABhAGMAZQAgAFUAdABpAGwAIAAtAE4AYQBtAGUAIABXAGkAbgBBAHAAaQAgACAALQBNAGUAbQBiAGUAcgBEAGUAZgBpAG4AaQB0AGkAbwBuACAAQAAiAAoAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAHUAcwBlAHIAMwAyAC4AZABsAGwAIgApAF0ACgAgACAAcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABGAGkAbgBkAFcAaQBuAGQAbwB3ACgAcwB0AHIAaQBuAGcAIABsAHAAQwBsAGEAcwBzAE4AYQBtAGUALAAgAHMAdAByAGkAbgBnACAAbABwAFcAaQBuAGQAbwB3AE4AYQBtAGUAKQA7AAoAIgBAAAoACgAkAGgAdwBuAGQAVABvAHAATQBvAHMAdABGAGkAbABlAEUAeABwAGwAbwByAGUAcgAgAD0AIABbAFUAdABpAGwALgBXAGkAbgBBAHAAaQBdADoAOgBGAGkAbgBkAFcAaQBuAGQAbwB3ACgACgAgACAAIgBDAGEAYgBpAG4AZQB0AFcAQwBsAGEAcwBzACIALAAgACAAIAAgACAAIwAgAHQAaABlACAAdwBpAG4AZABvAHcAIABjAGwAYQBzAHMAIABvAGYAIABpAG4AdABlAHIAZQBzAHQACgAgACAAWwBOAHUAbABsAFMAdAByAGkAbgBnAF0AOgA6AFYAYQBsAHUAZQAgACAAIwAgAG4AbwAgAHcAaQBuAGQAbwB3ACAAdABpAHQAbABlACAAdABvACAAcwBlAGEAcgBjAGgAIABmAG8AcgAKACkACgAKAEEAZABkAC0AVAB5AHAAZQAgAC0AVAB5AHAAZQBEAGUAZgBpAG4AaQB0AGkAbwBuACAAQAAiAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0AOwAKAHUAcwBpAG4AZwAgAFMAeQBzAHQAZQBtAC4AUgB1AG4AdABpAG0AZQAuAEkAbgB0AGUAcgBvAHAAUwBlAHIAdgBpAGMAZQBzADsACgAKAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABjAGwAYQBzAHMAIABXAGkAbgAzADIAIAB7AAoAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAFUAcwBlAHIAMwAyAC4AZABsAGwAIgAsACAARQBuAHQAcgB5AFAAbwBpAG4AdAA9ACIAUwBlAHQAVwBpAG4AZABvAHcAVABlAHgAdAAiACkAXQAKACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABpAG4AdAAgAFMAZQB0AFcAaQBuAGQAbwB3AFQAZQB4AHQAKABJAG4AdABQAHQAcgAgAGgAVwBuAGQALAAgAHMAdAByAGkAbgBnACAAcwB0AHIAVABpAHQAbABlACkAOwAKAH0ACgAiAEAACgAKAFsAVwBpAG4AMwAyAF0AOgA6AFMAZQB0AFcAaQBuAGQAbwB3AFQAZQB4AHQAKAAkAGgAdwBuAGQAVABvAHAATQBvAHMAdABGAGkAbABlAEUAeABwAGwAbwByAGUAcgAsACAAJABUAGgAaQBzAEcAaQB0AFMAdABhAHQAdQBzACkACgAKAFsAUwB5AHMAdABlAG0ALgBXAGkAbgBkAG8AdwBzAC4ATQBlAHMAcwBhAGcAZQBCAG8AeABdADoAOgBTAGgAbwB3ACgAJABSAGUAcwB1AGwAdABbADAAXQAsACcARwBpAHQAIABmAG8AcgAgAFcAaQBuAGQAbwB3AHMAJwAsADAALAAnAEkAbgBmAG8AJwApAA=="
